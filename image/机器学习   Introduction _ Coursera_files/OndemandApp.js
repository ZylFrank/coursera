define("bundles/confirmNavigation/nls/confirmNavigation",{es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0});
define("pages/open-course/common/views/nls/helpwidget",{es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0});
define('normalize.v0-1-8',[],function(){function convertURIBase(r,i,a){if(r.match(u)||r.match(t))return r;r=s(r);var n=a.match(t),e=i.match(t);if(e&&(!n||n[1]!=e[1]||n[2]!=e[2]))return absoluteURI(r,i);else return relativeURI(absoluteURI(r,i),a)}function absoluteURI(r,i){if("./"==r.substr(0,2))r=r.substr(2);if(r.match(u)||r.match(t))return r;var s=i.split("/"),n=r.split("/");for(s.pop();curPart=n.shift();)if(".."==curPart)s.pop();else s.push(curPart);return s.join("/")}function relativeURI(r,t){var s=t.split("/");for(s.pop(),t=s.join("/")+"/",i=0;t.substr(i,1)==r.substr(i,1);)i++;for(;"/"!=t.substr(i,1);)i--;t=t.substr(i+1),r=r.substr(i+1),s=t.split("/");var u=r.split("/");for(out="";s.shift();)out+="../";for(;curPart=u.shift();)out+=curPart+"/";return out.substr(0,out.length-1)}var n=/([^:])\/+/g,s=function(t){return t.replace(n,"$1/")},t=/[^\:\/]*:\/\/([^\/])*/,u=/^(\/|data:)/,r=function(r,n,e){n=s(n),e=s(e);for(var u=/@import\s*("([^"]*)"|'([^']*)')|url\s*\((?!#)\s*(\s*"([^"]*)"|'([^']*)'|[^\)]*\s*)\s*\)/gi,t,i,r;t=u.exec(r);){i=t[3]||t[2]||t[5]||t[6]||t[4];var a;a=convertURIBase(i,n,e);var o=t[5]||t[6]?1:0;r=r.substr(0,u.lastIndex-i.length-o-1)+a+r.substr(u.lastIndex-o-1),u.lastIndex=u.lastIndex+(a.length-i.length)}return r};return r.convertURIBase=convertURIBase,r.absoluteURI=absoluteURI,r.relativeURI=relativeURI,r});

define('css!bundles/helpwidget/index',[],function(){})

define('css!pages/open-course/common/styl/helpwidget',[],function(){})
define("js/lib/require.memoize",["module"],function(module){function argsToJsonHasher(){var r=Array.prototype.slice.call(arguments);return JSON.stringify(r)}function memoize(e,t){var n={};t=t||argsToJsonHasher;var r=function memoized(){var r=t.apply(this,arguments);if(!(r in n))n[r]=e.apply(this,arguments);return n[r]};return r.force=function(){return r.clear.apply(this,arguments),r.apply(this,arguments)},r.clear=function(){var r=t.apply(this,arguments);delete n[r]},r.reset=function(){n={}},r}var r={version:"0.0.1",load:function load(r,n,t,e){n([r],function(r){t(memoize(r))})}};return r});


define("js/json/nls/topics",{es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0});
define("js/json/nls/languages",{es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0});
define("js/json/nls/universities",{es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0});
define("nls/page",{es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0});
define("js/json/nls/specializations",{es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0});
define("js/json/nls/categories",{es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0});

define('css!bundles/socialPlugins/wechat/__styles__/wechat-button',[],function(){})
define("nls/socialPlugins",{es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0});



define('css!bundles/userModal/styl/userModal',[],function(){})


define("nls/ondemand",{es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0});






define("bundles/ondemand/actions/S12nActions",["require","exports","module","bundles/ondemand/actions/ServerActionCreators","bundles/phoenix/template/models/userIdentity","bundles/s12n-common/service/promises/s12nOwnershipPromiseFactory","pages/open-course/common/singletons/s12n"],function(require,exports,module){var e=require("bundles/ondemand/actions/ServerActionCreators"),n=require("bundles/phoenix/template/models/userIdentity"),s=require("bundles/s12n-common/service/promises/s12nOwnershipPromiseFactory"),o=require("pages/open-course/common/singletons/s12n"),t={loadS12n:function loadS12n(i,r){var t;o.then(function(e){if(t=e.at(0),t&&n.get("authenticated"))return s(t.get("id"))}).then(function(e){i.dispatch("UPDATE_LOADED",{s12n:t,ownership:e})}).fail(function(n){e.displayError(n)})}};module.exports=t});


define("nls/s12n",{es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0});
define("nls/s12n-enroll",{es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0});

define("pages/open-course/s12n/views/nls/banner",{es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0});

define('css!pages/open-course/s12n/styl/banner',[],function(){})
define("bundles/ondemand/stores/ErrorStore",["require","exports","module","underscore","js/vendor/EventEmitter","bundles/ondemand/dispatcher/OndemandDispatcher","bundles/ondemand/constants/Constants"],function(require,exports,module){var _=require("underscore"),s=require("js/vendor/EventEmitter"),r=require("bundles/ondemand/dispatcher/OndemandDispatcher"),o=require("bundles/ondemand/constants/Constants").Actions,e="change",t,n=_.extend({},s.prototype,{emitChange:function emitChange(){this.emit(e)},addChangeListener:function addChangeListener(n){this.on(e,n)},removeChangeListener:function removeChangeListener(n){this.removeListener(e,n)},getErrorMessage:function getErrorMessage(){return t}});n.dispatchToken=r.register(function(s){var e=s.action;switch(e.type){case o.DISPLAY_ERROR:t=e.message,n.emitChange()}}),module.exports=n});
define("bundles/ondemand/utils/goalApi",["require","exports","module","q","bundles/ondemand/actions/ServerActionCreators","bundles/ondemand/actions/ServerActionCreators","bundles/ondemand/constants/Constants","bundles/phoenix/lib/apiWrapper","bundles/phoenix/template/models/userIdentity","i18n!nls/ondemand","pages/open-course/common/singletons/course"],function(require,exports,module){var r=require("q"),e=require("bundles/ondemand/actions/ServerActionCreators"),t=require("bundles/ondemand/actions/ServerActionCreators"),s=require("bundles/ondemand/constants/Constants"),a=require("bundles/phoenix/lib/apiWrapper"),i=require("bundles/phoenix/template/models/userIdentity"),u=require("i18n!nls/ondemand"),d=require("pages/open-course/common/singletons/course"),o=a(s.goalApi,{type:"rest"}),n={constructBasePath:function constructBasePath(e,n){return e.toString()+"~"+n.toString()},getCourseIdAndUserId:function getCourseIdAndUserId(){return d.then(function(e){return[e.get("id"),i.get("id")]})},getGoal:function getGoal(){var r=this;return n.getCourseIdAndUserId().spread(function(e,n){return o.get(r.constructBasePath(n,e))}).then(function(o){var e=o.elements[0],r=e.goalType,s=e.description,n={goalType:r,description:s};return t.initGoalData(n),n}).fail(function(n){switch(n.status){case 404:t.initGoalData({goalType:"NOT_SET",description:""});break;default:e.displayError(n)}}).done()},sendGoal:function sendGoal(s,a){var t;return n.getCourseIdAndUserId().spread(function(e,n){return t={data:{userId:n,courseId:e,goalType:s,description:a}},r(o.post("",t))}).then(function(t){var n=t.elements[0],o=n.goalType,r=n.description;e.updateNewGoal({goalType:o,description:r})}).fail(function(n){e.displayError(n)}).done()}};module.exports=n});
define("bundles/ondemand/actions/ViewActionCreators",["require","exports","module","bundles/ondemand/constants/Constants","bundles/ondemand/dispatcher/OndemandDispatcher","bundles/ondemand/utils/goalApi"],function(require,exports,module){var n=require("bundles/ondemand/constants/Constants").Actions,e=require("bundles/ondemand/dispatcher/OndemandDispatcher"),d=require("bundles/ondemand/utils/goalApi"),s={sendGoal:function sendGoal(n,e){d.sendGoal(n,e)},toggleMobileMenu:function toggleMobileMenu(){e.handleViewAction({type:n.TOGGLE_MOBILE_MENU})}};module.exports=s});

define('css!bundles/page/components/__styles__/NewPageHeader',[],function(){})
define("bundles/phoenix/template/layout/nls/header",{es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0});

define('css!bundles/collapse/collapse',[],function(){})

define('css!bundles/phoenix/template/styl/index',[],function(){})

define('css!bundles/ondemand/components/__styles__/CoursePageHeader',[],function(){})
define("bundles/ondemand/components/CoursePageHeader",["require","exports","module","react-with-addons","bundles/ondemand/actions/ViewActionCreators","bundles/page/components/CourseraLogo","bundles/page/components/PageHeader","css!bundles/ondemand/components/__styles__/CoursePageHeader.css","js/lib/affix"],function(require,exports,module){var e=require("react-with-addons"),a=require("bundles/ondemand/actions/ViewActionCreators"),n=require("bundles/page/components/CourseraLogo"),t=require("bundles/page/components/PageHeader");require("css!bundles/ondemand/components/__styles__/CoursePageHeader.css"),require("js/lib/affix");var s=e.createClass({displayName:"MenuToggleButton",handleClick:function handleClick(){a.toggleMobileMenu()},render:function render(){return e.createElement("button",{className:"rc-MenuToggleButton bt3-navbar-toggle",onClick:this.handleClick},e.createElement("span",{className:"bt3-sr-only"},"Toggle side navigation"),e.createElement("span",{className:"bt3-icon-bar"}),e.createElement("span",{className:"bt3-icon-bar"}),e.createElement("span",{className:"bt3-icon-bar"}))}}),l=e.createClass({displayName:"MobileHeader",render:function render(){return e.createElement("div",{className:"rc-MobileHeader"},e.createElement("nav",{className:"c-nav",role:"navigation","data-affix":!0},e.createElement("div",{className:"horizontal-box align-items-absolute-center align-items-vertical-center"},e.createElement(s,null),e.createElement("a",{href:"/"},e.createElement(n,null)))))}}),r=e.createClass({displayName:"CoursePageHeader",render:function render(){return e.createElement("div",{className:"rc-CoursePageHeader"},e.createElement("div",{className:"bt3-hidden-xs"},e.createElement(t,null)),e.createElement("div",{className:"bt3-visible-xs"},e.createElement(l,null)))}});module.exports=r});

define('css!bundles/ondemand/components/common/__styles__/HomeBanner',[],function(){})
define("bundles/ondemand/components/common/HomeBanner",["require","exports","module","classnames","react-with-addons","css!./__styles__/HomeBanner.css"],function(require,exports,module){var s=require("classnames"),e=require("react-with-addons");require("css!./__styles__/HomeBanner.css");var a=e.createClass({displayName:"HomeBanner",propTypes:{message:e.PropTypes.string.isRequired},render:function render(){return e.createElement("div",{className:s("rc-HomeBanner",this.props.className)},e.createElement("div",{className:"message-container horizontal-box"},this.props.message))}});module.exports=a});

define('css!bundles/ondemand/components/__styles__/PrivilegedUserRolloutBanner',[],function(){})
define("bundles/ondemand/components/PrivilegedUserRolloutBanner",["require","exports","module","react-with-addons","underscore","bundles/epic/client","bundles/ondemand/components/common/HomeBanner","bundles/ondemand/stores/CourseMembershipStore","bundles/phoenix/template/models/userIdentity","i18n!nls/ondemand","pages/open-course/common/constants","css!./__styles__/PrivilegedUserRolloutBanner.css"],function(require,exports,module){var e=require("react-with-addons"),_=require("underscore"),n=require("bundles/epic/client"),s=require("bundles/ondemand/components/common/HomeBanner"),o=require("bundles/ondemand/stores/CourseMembershipStore"),r=require("bundles/phoenix/template/models/userIdentity"),t=require("i18n!nls/ondemand"),i=require("pages/open-course/common/constants"),l=i.courseId,a=t("This is a preview of the new course layout. It will be rolled out on August 10.\n Please contact your partnership manager for more information.");require("css!./__styles__/PrivilegedUserRolloutBanner.css");var d=e.createClass({displayName:"PrivilegedUserRolloutBanner",propTypes:{onUpdate:e.PropTypes.func.isRequired},getInitialState:function getInitialState(){return{isFullyLaunchedHome:_(n.get("siteOnDemandCompletion","fullyLaunchedHomeCourseIds")).contains(l),isPrivilegedUser:r.get("is_superuser")||o.hasTeachingRole()}},componentDidMount:function componentDidMount(){this.props.onUpdate()},render:function render(){if(this.state.isFullyLaunchedHome||!this.state.isPrivilegedUser)return null;return e.createElement(s,{message:a,className:"rc-PrivilegedUserRolloutBanner"})}});module.exports=d});
define("bundles/ondemand/components/PartnerLogo",["require","exports","module","react-with-addons"],function(require,exports,module){var e=require("react-with-addons"),t=e.createClass({displayName:"PartnerLogo",contextTypes:{track:e.PropTypes.func.isRequired},propTypes:{thumbnail:e.PropTypes.string,universityLink:e.PropTypes.string},render:function render(){return this.props.universityLink?e.createElement("a",{className:"nostyle",href:this.props.universityLink,target:"_blank",onClick:this.context.track.handle("menu.click.univ_logo")},e.createElement("img",{className:"od-thumbnail bgcolor-white",src:this.props.thumbnail,alt:"univlogo"})):e.createElement("img",{className:"od-thumbnail bgcolor-white bt3-hidden-xs",src:this.props.thumbnail,alt:"univlogo"})}});module.exports=t});
define("bundles/ondemand/components/CourseHeader",["require","exports","module","react-with-addons","js/lib/coursera.react-intl","i18n!nls/ondemand","bundles/ondemand/components/PartnerLogo"],function(require,exports,module){var e=require("react-with-addons"),n=require("js/lib/coursera.react-intl"),r=n.FormattedMessage,s=require("i18n!nls/ondemand"),t=require("bundles/ondemand/components/PartnerLogo"),a=e.createClass({displayName:"CourseHeader",contextTypes:{track:e.PropTypes.func.isRequired},propTypes:{title:e.PropTypes.string.isRequired,thumbnail:e.PropTypes.string,university:e.PropTypes.string.isRequired,universityLink:e.PropTypes.string},render:function render(){return e.createElement("div",{className:"rc-CourseHeader"},e.createElement("div",{className:"align-horizontal-center od-dark od-container cozy"},e.createElement(t,this.props),e.createElement("div",null,e.createElement("h5",{className:"od-course-name"},this.props.title),e.createElement("h6",{className:"od-uni-name"},e.createElement(r,{message:s("by {university}"),university:this.props.university})))))}});module.exports=a});
define("nls/certificate",{es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0});

define('css!bundles/ondemand/components/__styles__/CourseInfoHeader',[],function(){})

define('css!bundles/ondemand/components/enrollBox/__styles__/CoursePassedBox',[],function(){})

define('css!bundles/ondemand/assets/icons/icons',[],function(){})

define('css!bundles/ondemand/components/sessions/__styles__/SessionEnrollConfirmationModal',[],function(){})

define('css!bundles/ondemand/components/sessions/__styles__/SessionStartedModal',[],function(){})

define('css!bundles/ondemand/components/enrollBox/__styles__/SessionSwitchModal',[],function(){})

define('css!bundles/ondemand/components/enrollBox/__styles__/SessionSwitchBox',[],function(){})

define('css!bundles/ondemand/components/enrollBox/__styles__/EnrollBox',[],function(){})

define('css!bundles/ondemand/components/__styles__/HowToPass',[],function(){})

define('css!bundles/ondemand/components/__styles__/InstructorBox',[],function(){})

define('css!bundles/ondemand/components/__styles__/Syllabus',[],function(){})
define("bundles/page/lib/nls/metatagsAddressBook",{es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0});
define("pages/open-course/welcome/views/nls/body",{es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0});
define("nls/teach-community",{es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0});

define('css!bundles/teach-community/components/__styles__/JoinConfirmationModal',[],function(){})

define('css!bundles/ondemand/components/__styles__/CourseInfoPage',[],function(){})
define("nls/course-profile",{es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0});

define("bundles/course-profile/utils/lib",["require","exports","module","i18n!nls/course-profile"],function(require,exports,module){var e=require("i18n!nls/course-profile");exports.getProgressString=function(r,t){if(t)return e("Completed course");else if(25>r)return e("Getting Started");else if(50>r)return e("Halfway through");else if(75>r)return e("Almost completed");else return e("Completed course")},exports.getCourseRoleString=function(r){switch(r){case"INSTRUCTOR":return e("Instructor");case"TEACHING_STAFF":return e("Teaching Staff");case"UNIVERSITY_ADMIN":return e("Teaching Staff");case"MENTOR":return e("Mentor")}}});

define('css!bundles/phoenix/components/__styles__/ProfileImage',[],function(){})
var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var r in s)if(Object.prototype.hasOwnProperty.call(s,r))t[r]=s[r]}return t};define("bundles/phoenix/components/ProfileImage",["require","exports","module","classnames","react-with-addons","js/components/Imgix","css!bundles/phoenix/components/__styles__/ProfileImage.css"],function(require,exports,module){var s=require("classnames"),e=require("react-with-addons"),r=require("js/components/Imgix");require("css!bundles/phoenix/components/__styles__/ProfileImage.css");var t=e.createClass({displayName:"ProfileImage",propTypes:{profileImageUrl:e.PropTypes.string,fullName:e.PropTypes.string,width:e.PropTypes.number,height:e.PropTypes.number},render:function render(){var a,i={fit:"facearea"};if(this.props.profileImageUrl)a=e.createElement(r,_extends({src:this.props.profileImageUrl},this.props,{imgParams:i}));else if(this.props.fullName){var t=this.props.fullName.trim().split(" "),n=t[0][0],l=t.length>1?t[t.length-1][0]:"";a=e.createElement("div",{className:"horizontal-box align-items-absolute-center"},e.createElement("p",null,n+l))}var o=s("c-profile-image",{"c-profile-initials":!this.props.profileImageUrl});return e.createElement("div",{className:"rc-ProfileImage"},e.createElement("div",{className:o},a))}});module.exports=t});

define('css!bundles/ondemand/components/classmates/__styles__/ClassmatesProfile',[],function(){})
define("bundles/ondemand/components/classmates/ClassmatesProfile",["require","exports","module","i18n!nls/ondemand","react-with-addons","react-router","pages/open-course/common/constants","js/lib/path","bundles/course-profile/utils/lib","bundles/phoenix/components/ProfileImage","css!./__styles__/ClassmatesProfile.css"],function(require,exports,module){var s=require("i18n!nls/ondemand"),e=require("react-with-addons"),r=require("react-router"),t=r.Link,a=require("pages/open-course/common/constants"),l=require("js/lib/path"),o=require("bundles/course-profile/utils/lib"),c=o.getProgressString,n=require("bundles/phoenix/components/ProfileImage");require("css!./__styles__/ClassmatesProfile.css");var i=e.createClass({displayName:"ClassmatesProfile",propTypes:{profile:e.PropTypes.object.isRequired},contextTypes:{track:e.PropTypes.func.isRequired},trackProfileClick:function trackProfileClick(){this.context.track("classmates.click.profile",{external_user_id:this.props.profile.id})},render:function render(){var r=this.props.profile;return e.createElement("div",{className:"rc-ClassmatesProfile card-z1"},e.createElement(t,{onClick:this.trackProfileClick,to:l.join(a.courseRootPath,"profiles",r.id),className:"nostyle"},e.createElement("div",{className:""},e.createElement("div",{className:"c-cm-image"},e.createElement(n,{fullName:r.fullName,profileImageUrl:r.photoUrl})),e.createElement("h4",{className:"c-cm-name"},r.fullName)),e.createElement("div",{className:"flex c-cm-progress"},e.createElement("span",null,s("Progress"),": "),e.createElement("span",{className:"od-text-bold"},c(r.courseProgressPercentage)))))}});module.exports=i});
!function(e,i,n){var a=e.L,t={};if(t.version="0.7.2","object"==typeof module&&"object"==typeof module.exports)module.exports=t;else if("function"==typeof define&&define.amd)define("leaflet",t);t.noConflict=function(){return e.L=a,this},e.L=t,t.Util={extend:function(n){var o=Array.prototype.slice.call(arguments,1),t,i,s,e;for(i=0,s=o.length;s>i;i++){e=o[i]||{};for(t in e)if(e.hasOwnProperty(t))n[t]=e[t]}return n},bind:function(t,i){var e=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return t.apply(i,e||arguments)}},stamp:function(){var i=0,t="_leaflet_id";return function(e){return e[t]=e[t]||++i,e[t]}}(),invokeEach:function(t,n,o){var i,e;if("object"==typeof t){e=Array.prototype.slice.call(arguments,3);for(i in t)n.apply(o,[i,t[i]].concat(e));return!0}return!1},limitExecByInterval:function(n,o,e){var t,i;return function wrapperFn(){var s=arguments;if(t)return void(i=!0);t=!0,setTimeout(function(){if(t=!1,i)wrapperFn.apply(e,s),i=!1},o),n.apply(e,s)}},falseFn:function(){return!1},formatNum:function(i,e){var t=Math.pow(10,e||5);return Math.round(i*t)/t},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},splitWords:function(i){return t.Util.trim(i).split(/\s+/)},setOptions:function(i,e){return i.options=t.extend({},i.options,e),i.options},getParamString:function(i,e,o){var n=[];for(var t in i)n.push(encodeURIComponent(o?t.toUpperCase():t)+"="+encodeURIComponent(i[t]));return(!e||-1===e.indexOf("?")?"?":"&")+n.join("&")},template:function(i,t){return i.replace(/\{ *([\w_]+) *\}/g,function(e,o){var i=t[o];if(i===n)throw new Error("No value provided for variable "+e);else if("function"==typeof i)i=i(t);return i})},isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function getPrefixed(o){var t,i,n=["webkit","moz","o","ms"];for(t=0;t<n.length&&!i;t++)i=e[n[t]+o];return i}function timeoutDefer(o){var t=+new Date,n=Math.max(0,16-(t-i));return i=t+n,e.setTimeout(o,n)}var i=0,n=e.requestAnimationFrame||getPrefixed("RequestAnimationFrame")||timeoutDefer,o=e.cancelAnimationFrame||getPrefixed("CancelAnimationFrame")||getPrefixed("CancelRequestAnimationFrame")||function(t){e.clearTimeout(t)};t.Util.requestAnimFrame=function(i,o,s,a){if(i=t.bind(i,o),s&&n===timeoutDefer)i();else return n.call(e,i,a)},t.Util.cancelAnimFrame=function(t){if(t)o.call(e,t)}}(),t.extend=t.Util.extend,t.bind=t.Util.bind,t.stamp=t.Util.stamp,t.setOptions=t.Util.setOptions,t.Class=function(){},t.Class.extend=function(i){var n=function(){if(this.initialize)this.initialize.apply(this,arguments);if(this._initHooks)this.callInitHooks()},a=function(){};a.prototype=this.prototype;var e=new a;e.constructor=n,n.prototype=e;for(var o in this)if(this.hasOwnProperty(o)&&"prototype"!==o)n[o]=this[o];if(i.statics)t.extend(n,i.statics),delete i.statics;if(i.includes)t.Util.extend.apply(null,[e].concat(i.includes)),delete i.includes;if(i.options&&e.options)i.options=t.extend({},e.options,i.options);t.extend(e,i),e._initHooks=[];var s=this;return n.__super__=s.prototype,e.callInitHooks=function(){if(this._initHooksCalled)return;if(s.prototype.callInitHooks)s.prototype.callInitHooks.call(this);this._initHooksCalled=!0;for(var t=0,i=e._initHooks.length;i>t;t++)e._initHooks[t].call(this)},n},t.Class.include=function(i){t.extend(this.prototype,i)},t.Class.mergeOptions=function(i){t.extend(this.prototype.options,i)},t.Class.addInitHook=function(t){var i=Array.prototype.slice.call(arguments,1),e="function"==typeof t?t:function(){this[t].apply(this,i)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(e)};var o="_leaflet_events";t.Mixin={},t.Mixin.Events={addEventListener:function(e,f,n){if(t.Util.invokeEach(e,this.addEventListener,this,f,n))return this;var i=this[o]=this[o]||{},a=n&&n!==this&&t.stamp(n),r,d,u,s,h,c,l;for(e=t.Util.splitWords(e),r=0,d=e.length;d>r;r++)if(u={action:f,context:n||this},s=e[r],a){if(h=s+"_idx",c=h+"_len",l=i[h]=i[h]||{},!l[a])l[a]=[],i[c]=(i[c]||0)+1;l[a].push(u)}else i[s]=i[s]||[],i[s].push(u);return this},hasEventListeners:function(i){var t=this[o];return!!t&&(i in t&&t[i].length>0||i+"_idx"in t&&t[i+"_idx_len"]>0)},removeEventListener:function(e,c,i){if(!this[o])return this;if(!e)return this.clearAllEventListeners();if(t.Util.invokeEach(e,this.removeEventListener,this,c,i))return this;var n=this[o],d=i&&i!==this&&t.stamp(i),u,p,l,a,s,h,f,r,m;for(e=t.Util.splitWords(e),u=0,p=e.length;p>u;u++)if(l=e[u],h=l+"_idx",f=h+"_len",r=n[h],!c)delete n[l],delete n[h],delete n[f];else if(a=d&&r?r[d]:n[l]){for(s=a.length-1;s>=0;s--)if(a[s].action===c&&(!i||a[s].context===i))m=a.splice(s,1),m[0].action=t.Util.falseFn;if(i&&r&&0===a.length)delete r[d],n[f]--}return this},clearAllEventListeners:function(){return delete this[o],this},fireEvent:function(n,u){if(!this.hasEventListeners(n))return this;var h=t.Util.extend({},u,{type:n,target:this}),a=this[o],e,i,s,r,l;if(a[n])for(e=a[n].slice(),i=0,s=e.length;s>i;i++)e[i].action.call(e[i].context,h);r=a[n+"_idx"];for(l in r)if(e=r[l].slice())for(i=0,s=e.length;s>i;i++)e[i].action.call(e[i].context,h);return this},addOneTimeEventListener:function(i,n,e){if(t.Util.invokeEach(i,this.addOneTimeEventListener,this,n,e))return this;var o=t.bind(function(){this.removeEventListener(i,n,e).removeEventListener(i,o,e)},this);return this.addEventListener(i,n,e).addEventListener(i,o,e)}},t.Mixin.Events.on=t.Mixin.Events.addEventListener,t.Mixin.Events.off=t.Mixin.Events.removeEventListener,t.Mixin.Events.once=t.Mixin.Events.addOneTimeEventListener,t.Mixin.Events.fire=t.Mixin.Events.fireEvent,function(){var s="ActiveXObject"in e,y=s&&!i.addEventListener,o=navigator.userAgent.toLowerCase(),h=-1!==o.indexOf("webkit"),x=-1!==o.indexOf("chrome"),g=-1!==o.indexOf("phantom"),L=-1!==o.indexOf("android"),c=-1!==o.search("android [23]"),P=-1!==o.indexOf("gecko"),a=typeof orientation!=n+"",f=e.navigator&&e.navigator.msPointerEnabled&&e.navigator.msMaxTouchPoints&&!e.PointerEvent,m=e.PointerEvent&&e.navigator.pointerEnabled&&e.navigator.maxTouchPoints||f,v="devicePixelRatio"in e&&e.devicePixelRatio>1||"matchMedia"in e&&e.matchMedia("(min-resolution:144dpi)")&&e.matchMedia("(min-resolution:144dpi)").matches,r=i.documentElement,p=s&&"transition"in r.style,l="WebKitCSSMatrix"in e&&"m11"in new e.WebKitCSSMatrix&&!c,u="MozPerspective"in r.style,d="OTransition"in r.style,w=!e.L_DISABLE_3D&&(p||l||u||d)&&!g,T=!e.L_NO_TOUCH&&!g&&function(){var e="ontouchstart";if(m||e in r)return!0;var t=i.createElement("div"),n=!1;if(!t.setAttribute)return!1;if(t.setAttribute(e,"return;"),"function"==typeof t[e])n=!0;return t.removeAttribute(e),t=null,n}();t.Browser={ie:s,ielt9:y,webkit:h,gecko:P&&!h&&!e.opera&&!s,android:L,android23:c,chrome:x,ie3d:p,webkit3d:l,gecko3d:u,opera3d:d,any3d:w,mobile:a,mobileWebkit:a&&h,mobileWebkit3d:a&&l,mobileOpera:a&&e.opera,touch:T,msPointer:f,pointer:m,retina:v}}(),t.Point=function(t,i,e){this.x=e?Math.round(t):t,this.y=e?Math.round(i):i},t.Point.prototype={clone:function(){return new t.Point(this.x,this.y)},add:function(i){return this.clone()._add(t.point(i))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(i){return this.clone()._subtract(t.point(i))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},distanceTo:function(i){i=t.point(i);var e=i.x-this.x,n=i.y-this.y;return Math.sqrt(e*e+n*n)},equals:function(i){return i=t.point(i),i.x===this.x&&i.y===this.y},contains:function(i){return i=t.point(i),Math.abs(i.x)<=Math.abs(this.x)&&Math.abs(i.y)<=Math.abs(this.y)},toString:function(){return"Point("+t.Util.formatNum(this.x)+", "+t.Util.formatNum(this.y)+")"}},t.point=function(i,e,o){if(i instanceof t.Point)return i;if(t.Util.isArray(i))return new t.Point(i[0],i[1]);if(i===n||null===i)return i;return new t.Point(i,e,o)},t.Bounds=function(t,e){if(!t)return;for(var n=e?[t,e]:t,i=0,o=n.length;o>i;i++)this.extend(n[i])},t.Bounds.prototype={extend:function(i){if(i=t.point(i),!this.min&&!this.max)this.min=i.clone(),this.max=i.clone();else this.min.x=Math.min(i.x,this.min.x),this.max.x=Math.max(i.x,this.max.x),this.min.y=Math.min(i.y,this.min.y),this.max.y=Math.max(i.y,this.max.y);return this},getCenter:function(i){return new t.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,i)},getBottomLeft:function(){return new t.Point(this.min.x,this.max.y)},getTopRight:function(){return new t.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(i){var e,n;if("number"==typeof i[0]||i instanceof t.Point)i=t.point(i);else i=t.bounds(i);if(i instanceof t.Bounds)e=i.min,n=i.max;else e=n=i;return e.x>=this.min.x&&n.x<=this.max.x&&e.y>=this.min.y&&n.y<=this.max.y},intersects:function(i){i=t.bounds(i);var e=this.min,n=this.max,o=i.min,s=i.max,a=s.x>=e.x&&o.x<=n.x,r=s.y>=e.y&&o.y<=n.y;return a&&r},isValid:function(){return!(!this.min||!this.max)}},t.bounds=function(i,e){if(!i||i instanceof t.Bounds)return i;return new t.Bounds(i,e)},t.Transformation=function(t,i,e,n){this._a=t,this._b=i,this._c=e,this._d=n},t.Transformation.prototype={transform:function(t,i){return this._transform(t.clone(),i)},_transform:function(t,i){return i=i||1,t.x=i*(this._a*t.x+this._b),t.y=i*(this._c*t.y+this._d),t},untransform:function(e,i){return i=i||1,new t.Point((e.x/i-this._b)/this._a,(e.y/i-this._d)/this._c)}},t.DomUtil={get:function(t){return"string"==typeof t?i.getElementById(t):t},getStyle:function(e,n){var t=e.style[n];if(!t&&e.currentStyle)t=e.currentStyle[n];if((!t||"auto"===t)&&i.defaultView){var o=i.defaultView.getComputedStyle(e,null);t=o?o[n]:null}return"auto"===t?null:t},getViewportOffset:function(h){var n=0,o=0,e=h,s=i.body,r=i.documentElement,a;do{if(n+=e.offsetTop||0,o+=e.offsetLeft||0,n+=parseInt(t.DomUtil.getStyle(e,"borderTopWidth"),10)||0,o+=parseInt(t.DomUtil.getStyle(e,"borderLeftWidth"),10)||0,a=t.DomUtil.getStyle(e,"position"),e.offsetParent===s&&"absolute"===a)break;if("fixed"===a){n+=s.scrollTop||r.scrollTop||0,o+=s.scrollLeft||r.scrollLeft||0;break}if("relative"===a&&!e.offsetLeft){var u=t.DomUtil.getStyle(e,"width"),c=t.DomUtil.getStyle(e,"max-width"),l=e.getBoundingClientRect();if("none"!==u||"none"!==c)o+=l.left+e.clientLeft;n+=l.top+(s.scrollTop||r.scrollTop||0);break}e=e.offsetParent}while(e);e=h;do{if(e===s)break;n-=e.scrollTop||0,o-=e.scrollLeft||0,e=e.parentNode}while(e);return new t.Point(o,n)},documentIsLtr:function(){if(!t.DomUtil._docIsLtrCached)t.DomUtil._docIsLtrCached=!0,t.DomUtil._docIsLtr="ltr"===t.DomUtil.getStyle(i.body,"direction");return t.DomUtil._docIsLtr},create:function(n,o,e){var t=i.createElement(n);if(t.className=o,e)e.appendChild(t);return t},hasClass:function(i,e){if(i.classList!==n)return i.classList.contains(e);var o=t.DomUtil._getClass(i);return o.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(o)},addClass:function(i,e){if(i.classList!==n)for(var s=t.Util.splitWords(e),o=0,r=s.length;r>o;o++)i.classList.add(s[o]);else if(!t.DomUtil.hasClass(i,e)){var a=t.DomUtil._getClass(i);t.DomUtil._setClass(i,(a?a+" ":"")+e)}},removeClass:function(i,e){if(i.classList!==n)i.classList.remove(e);else t.DomUtil._setClass(i,t.Util.trim((" "+t.DomUtil._getClass(i)+" ").replace(" "+e+" "," ")))},_setClass:function(t,i){if(t.className.baseVal===n)t.className=i;else t.className.baseVal=i},_getClass:function(t){return t.className.baseVal===n?t.className:t.className.baseVal},setOpacity:function(i,t){if("opacity"in i.style)i.style.opacity=t;else if("filter"in i.style){var e=!1,n="DXImageTransform.Microsoft.Alpha";try{e=i.filters.item(n)}catch(o){if(1===t)return}if(t=Math.round(100*t),e)e.Enabled=100!==t,e.Opacity=t;else i.style.filter+=" progid:"+n+"(opacity="+t+")"}},testProp:function(e){for(var n=i.documentElement.style,t=0;t<e.length;t++)if(e[t]in n)return e[t];return!1},getTranslateString:function(i){var e=t.Browser.webkit3d,n="translate"+(e?"3d":"")+"(",o=(e?",0":"")+")";return n+i.x+"px,"+i.y+"px"+o},getScaleString:function(i,e){var n=t.DomUtil.getTranslateString(e.add(e.multiplyBy(-1*i))),o=" scale("+i+") ";return n+o},setPosition:function(i,e,n){if(i._leaflet_pos=e,!n&&t.Browser.any3d)i.style[t.DomUtil.TRANSFORM]=t.DomUtil.getTranslateString(e);else i.style.left=e.x+"px",i.style.top=e.y+"px"},getPosition:function(t){return t._leaflet_pos}},t.DomUtil.TRANSFORM=t.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),t.DomUtil.TRANSITION=t.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),t.DomUtil.TRANSITION_END="webkitTransition"===t.DomUtil.TRANSITION||"OTransition"===t.DomUtil.TRANSITION?t.DomUtil.TRANSITION+"End":"transitionend",function(){if("onselectstart"in i)t.extend(t.DomUtil,{disableTextSelection:function(){t.DomEvent.on(e,"selectstart",t.DomEvent.preventDefault)},enableTextSelection:function(){t.DomEvent.off(e,"selectstart",t.DomEvent.preventDefault)}});else{var n=t.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);t.extend(t.DomUtil,{disableTextSelection:function(){if(n){var t=i.documentElement.style;this._userSelect=t[n],t[n]="none"}},enableTextSelection:function(){if(n)i.documentElement.style[n]=this._userSelect,delete this._userSelect}})}t.extend(t.DomUtil,{disableImageDrag:function(){t.DomEvent.on(e,"dragstart",t.DomEvent.preventDefault)},enableImageDrag:function(){t.DomEvent.off(e,"dragstart",t.DomEvent.preventDefault)}})}(),t.LatLng=function(t,i,e){if(t=parseFloat(t),i=parseFloat(i),isNaN(t)||isNaN(i))throw new Error("Invalid LatLng object: ("+t+", "+i+")");if(this.lat=t,this.lng=i,e!==n)this.alt=parseFloat(e)},t.extend(t.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),t.LatLng.prototype={equals:function(i){if(!i)return!1;i=t.latLng(i);var e=Math.max(Math.abs(this.lat-i.lat),Math.abs(this.lng-i.lng));return e<=t.LatLng.MAX_MARGIN},toString:function(i){return"LatLng("+t.Util.formatNum(this.lat,i)+", "+t.Util.formatNum(this.lng,i)+")"},distanceTo:function(i){i=t.latLng(i);var a=6378137,e=t.LatLng.DEG_TO_RAD,r=(i.lat-this.lat)*e,h=(i.lng-this.lng)*e,l=this.lat*e,u=i.lat*e,n=Math.sin(r/2),o=Math.sin(h/2),s=n*n+o*o*Math.cos(l)*Math.cos(u);return 2*a*Math.atan2(Math.sqrt(s),Math.sqrt(1-s))},wrap:function(e,i){var n=this.lng;return e=e||-180,i=i||180,n=(n+i)%(i-e)+(e>n||n===i?i:e),new t.LatLng(this.lat,n)}},t.latLng=function(i,e){if(i instanceof t.LatLng)return i;if(t.Util.isArray(i))if("number"==typeof i[0]||"string"==typeof i[0])return new t.LatLng(i[0],i[1],i[2]);else return null;if(i===n||null===i)return i;if("object"==typeof i&&"lat"in i)return new t.LatLng(i.lat,"lng"in i?i.lng:i.lon);if(e===n)return null;return new t.LatLng(i,e)},t.LatLngBounds=function(t,e){if(!t)return;for(var n=e?[t,e]:t,i=0,o=n.length;o>i;i++)this.extend(n[i])},t.LatLngBounds.prototype={extend:function(i){if(!i)return this;var e=t.latLng(i);if(null!==e)i=e;else i=t.latLngBounds(i);if(i instanceof t.LatLng)if(!this._southWest&&!this._northEast)this._southWest=new t.LatLng(i.lat,i.lng),this._northEast=new t.LatLng(i.lat,i.lng);else this._southWest.lat=Math.min(i.lat,this._southWest.lat),this._southWest.lng=Math.min(i.lng,this._southWest.lng),this._northEast.lat=Math.max(i.lat,this._northEast.lat),this._northEast.lng=Math.max(i.lng,this._northEast.lng);else if(i instanceof t.LatLngBounds)this.extend(i._southWest),this.extend(i._northEast);return this},pad:function(n){var i=this._southWest,e=this._northEast,o=Math.abs(i.lat-e.lat)*n,s=Math.abs(i.lng-e.lng)*n;return new t.LatLngBounds(new t.LatLng(i.lat-o,i.lng-s),new t.LatLng(e.lat+o,e.lng+s))},getCenter:function(){return new t.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new t.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new t.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(i){if("number"==typeof i[0]||i instanceof t.LatLng)i=t.latLng(i);else i=t.latLngBounds(i);var o=this._southWest,s=this._northEast,e,n;if(i instanceof t.LatLngBounds)e=i.getSouthWest(),n=i.getNorthEast();else e=n=i;return e.lat>=o.lat&&n.lat<=s.lat&&e.lng>=o.lng&&n.lng<=s.lng},intersects:function(i){i=t.latLngBounds(i);var e=this._southWest,n=this._northEast,o=i.getSouthWest(),s=i.getNorthEast(),a=s.lat>=e.lat&&o.lat<=n.lat,r=s.lng>=e.lng&&o.lng<=n.lng;return a&&r},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(i){if(!i)return!1;return i=t.latLngBounds(i),this._southWest.equals(i.getSouthWest())&&this._northEast.equals(i.getNorthEast())},isValid:function(){return!(!this._southWest||!this._northEast)}},t.latLngBounds=function(i,e){if(!i||i instanceof t.LatLngBounds)return i;return new t.LatLngBounds(i,e)},t.Projection={},t.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(e){var n=t.LatLng.DEG_TO_RAD,o=this.MAX_LATITUDE,s=Math.max(Math.min(o,e.lat),-o),a=e.lng*n,i=s*n;return i=Math.log(Math.tan(Math.PI/4+i/2)),new t.Point(a,i)},unproject:function(i){var e=t.LatLng.RAD_TO_DEG,n=i.x*e,o=(2*Math.atan(Math.exp(i.y))-Math.PI/2)*e;return new t.LatLng(o,n)}},t.Projection.LonLat={project:function(i){return new t.Point(i.lng,i.lat)},unproject:function(i){return new t.LatLng(i.y,i.x)}},t.CRS={latLngToPoint:function(t,i){var e=this.projection.project(t),n=this.scale(i);return this.transformation._transform(e,n)},pointToLatLng:function(t,i){var e=this.scale(i),n=this.transformation.untransform(t,e);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},scale:function(t){return 256*Math.pow(2,t)},getSize:function(e){var i=this.scale(e);return t.point(i,i)}},t.CRS.Simple=t.extend({},t.CRS,{projection:t.Projection.LonLat,transformation:new t.Transformation(1,0,-1,0),scale:function(t){return Math.pow(2,t)}}),t.CRS.EPSG3857=t.extend({},t.CRS,{code:"EPSG:3857",projection:t.Projection.SphericalMercator,transformation:new t.Transformation(.5/Math.PI,.5,-.5/Math.PI,.5),project:function(t){var i=this.projection.project(t),e=6378137;return i.multiplyBy(e)}}),t.CRS.EPSG900913=t.extend({},t.CRS.EPSG3857,{code:"EPSG:900913"}),t.CRS.EPSG4326=t.extend({},t.CRS,{code:"EPSG:4326",projection:t.Projection.LonLat,transformation:new t.Transformation(1/360,.5,-1/360,.5)}),t.Map=t.Class.extend({includes:t.Mixin.Events,options:{crs:t.CRS.EPSG3857,fadeAnimation:t.DomUtil.TRANSITION&&!t.Browser.android23,trackResize:!0,markerZoomAnimation:t.DomUtil.TRANSITION&&t.Browser.any3d},initialize:function(e,i){if(i=t.setOptions(this,i),this._initContainer(e),this._initLayout(),this._onResize=t.bind(this._onResize,this),this._initEvents(),i.maxBounds)this.setMaxBounds(i.maxBounds);if(i.center&&i.zoom!==n)this.setView(t.latLng(i.center),i.zoom,{reset:!0});this._handlers=[],this._layers={},this._zoomBoundLayers={},this._tileLayersNum=0,this.callInitHooks(),this._addLayers(i.layers)},setView:function(e,i){return i=i===n?this.getZoom():i,this._resetView(t.latLng(e),this._limitZoom(i)),this},setZoom:function(t,i){if(!this._loaded)return this._zoom=this._limitZoom(t),this;return this.setView(this.getCenter(),t,{zoom:i})},zoomIn:function(t,i){return this.setZoom(this._zoom+(t||1),i)},zoomOut:function(t,i){return this.setZoom(this._zoom-(t||1),i)},setZoomAround:function(i,e,o){var s=this.getZoomScale(e),n=this.getSize().divideBy(2),a=i instanceof t.Point?i:this.latLngToContainerPoint(i),r=a.subtract(n).multiplyBy(1-1/s),h=this.containerPointToLatLng(n.add(r));return this.setView(h,e,{zoom:o})},fitBounds:function(e,i){i=i||{},e=e.getBounds?e.getBounds():t.latLngBounds(e);var o=t.point(i.paddingTopLeft||i.padding||[0,0]),s=t.point(i.paddingBottomRight||i.padding||[0,0]),n=this.getBoundsZoom(e,!1,o.add(s)),a=s.subtract(o).divideBy(2),r=this.project(e.getSouthWest(),n),h=this.project(e.getNorthEast(),n),l=this.unproject(r.add(h).divideBy(2).add(a),n);return n=i&&i.maxZoom?Math.min(i.maxZoom,n):n,this.setView(l,n,i)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,i){return this.setView(t,this._zoom,{pan:i})},panBy:function(i){return this.fire("movestart"),this._rawPanBy(t.point(i)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(i){if(i=t.latLngBounds(i),this.options.maxBounds=i,!i)return this.off("moveend",this._panInsideMaxBounds,this);if(this._loaded)this._panInsideMaxBounds();return this.on("moveend",this._panInsideMaxBounds,this)},panInsideBounds:function(e,n){var t=this.getCenter(),i=this._limitCenter(t,this._zoom,e);if(t.equals(i))return this;return this.panTo(i,n)},addLayer:function(i){var e=t.stamp(i);if(this._layers[e])return this;if(this._layers[e]=i,i.options&&(!isNaN(i.options.maxZoom)||!isNaN(i.options.minZoom)))this._zoomBoundLayers[e]=i,this._updateZoomLevels();if(this.options.zoomAnimation&&t.TileLayer&&i instanceof t.TileLayer)this._tileLayersNum++,this._tileLayersToLoad++,i.on("load",this._onTileLayerLoad,this);if(this._loaded)this._layerAdd(i);return this},removeLayer:function(i){var e=t.stamp(i);if(!this._layers[e])return this;if(this._loaded)i.onRemove(this);if(delete this._layers[e],this._loaded)this.fire("layerremove",{layer:i});if(this._zoomBoundLayers[e])delete this._zoomBoundLayers[e],this._updateZoomLevels();if(this.options.zoomAnimation&&t.TileLayer&&i instanceof t.TileLayer)this._tileLayersNum--,this._tileLayersToLoad--,i.off("load",this._onTileLayerLoad,this);return this},hasLayer:function(i){if(!i)return!1;return t.stamp(i)in this._layers},eachLayer:function(t,i){for(var e in this._layers)t.call(i,this._layers[e]);return this},invalidateSize:function(i){if(!this._loaded)return this;i=t.extend({animate:!1,pan:!0},i===!0?{animate:!0}:i);var n=this.getSize();this._sizeChanged=!0,this._initialCenter=null;var o=this.getSize(),s=n.divideBy(2).round(),a=o.divideBy(2).round(),e=s.subtract(a);if(!e.x&&!e.y)return this;if(i.animate&&i.pan)this.panBy(e);else{if(i.pan)this._rawPanBy(e);if(this.fire("move"),i.debounceMoveend)clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(t.bind(this.fire,this,"moveend"),200);else this.fire("moveend")}return this.fire("resize",{oldSize:n,newSize:o})},addHandler:function(t,i){if(!i)return this;var e=this[t]=new i(this);if(this._handlers.push(e),this.options[t])e.enable();return this},remove:function(){if(this._loaded)this.fire("unload");this._initEvents("off");try{delete this._container._leaflet}catch(t){this._container._leaflet=n}if(this._clearPanes(),this._clearControlPos)this._clearControlPos();return this._clearHandlers(),this},getCenter:function(){if(this._checkIfLoaded(),this._initialCenter&&!this._moved())return this._initialCenter;return this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var i=this.getPixelBounds(),e=this.unproject(i.getBottomLeft()),n=this.unproject(i.getTopRight());return new t.LatLngBounds(e,n)},getMinZoom:function(){return this.options.minZoom===n?this._layersMinZoom===n?0:this._layersMinZoom:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===n?this._layersMaxZoom===n?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(e,n,s){e=t.latLngBounds(e);var i=this.getMinZoom()-(n?1:0),h=this.getMaxZoom(),a=this.getSize(),l=e.getNorthWest(),u=e.getSouthEast(),r=!0,o;s=t.point(s||[0,0]);do i++,o=this.project(u,i).subtract(this.project(l,i)).add(s),r=!n?a.contains(o):o.x<a.x||o.y<a.y;while(r&&h>=i);if(r&&n)return null;return n?i:i-1},getSize:function(){if(!this._size||this._sizeChanged)this._size=new t.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1;return this._size.clone()},getPixelBounds:function(){var i=this._getTopLeftPoint();return new t.Bounds(i,i.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(i){var t=this.options.crs;return t.scale(i)/t.scale(this._zoom)},getScaleZoom:function(t){return this._zoom+Math.log(t)/Math.LN2},project:function(e,i){return i=i===n?this._zoom:i,this.options.crs.latLngToPoint(t.latLng(e),i)},unproject:function(e,i){return i=i===n?this._zoom:i,this.options.crs.pointToLatLng(t.point(e),i)},layerPointToLatLng:function(i){var e=t.point(i).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(i){var e=this.project(t.latLng(i))._round();return e._subtract(this.getPixelOrigin())},containerPointToLayerPoint:function(i){return t.point(i).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(i){return t.point(i).add(this._getMapPanePos())},containerPointToLatLng:function(i){var e=this.containerPointToLayerPoint(t.point(i));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(i){return this.layerPointToContainerPoint(this.latLngToLayerPoint(t.latLng(i)))},mouseEventToContainerPoint:function(i){return t.DomEvent.getMousePosition(i,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(e){var i=this._container=t.DomUtil.get(e);if(!i)throw new Error("Map container not found.");else if(i._leaflet)throw new Error("Map container is already initialized.");i._leaflet=!0},_initLayout:function(){var i=this._container;t.DomUtil.addClass(i,"leaflet-container"+(t.Browser.touch?" leaflet-touch":"")+(t.Browser.retina?" leaflet-retina":"")+(t.Browser.ielt9?" leaflet-oldie":"")+(this.options.fadeAnimation?" leaflet-fade-anim":""));var e=t.DomUtil.getStyle(i,"position");if("absolute"!==e&&"relative"!==e&&"fixed"!==e)i.style.position="relative";if(this._initPanes(),this._initControlPos)this._initControlPos()},_initPanes:function(){var i=this._panes={};this._mapPane=i.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=i.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),i.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),i.shadowPane=this._createPane("leaflet-shadow-pane"),i.overlayPane=this._createPane("leaflet-overlay-pane"),i.markerPane=this._createPane("leaflet-marker-pane"),i.popupPane=this._createPane("leaflet-popup-pane");var e=" leaflet-zoom-hide";if(!this.options.markerZoomAnimation)t.DomUtil.addClass(i.markerPane,e),t.DomUtil.addClass(i.shadowPane,e),t.DomUtil.addClass(i.popupPane,e)},_createPane:function(i,e){return t.DomUtil.create("div",i,e||this._panes.objectsPane)},_clearPanes:function(){this._container.removeChild(this._mapPane)},_addLayers:function(i){i=i?t.Util.isArray(i)?i:[i]:[];for(var e=0,n=i.length;n>e;e++)this.addLayer(i[e])},_resetView:function(e,n,i,o){var s=this._zoom!==n;if(!o)if(this.fire("movestart"),s)this.fire("zoomstart");if(this._zoom=n,this._initialCenter=e,this._initialTopLeftPoint=this._getNewTopLeftPoint(e),!i)t.DomUtil.setPosition(this._mapPane,new t.Point(0,0));else this._initialTopLeftPoint._add(this._getMapPanePos());this._tileLayersToLoad=this._tileLayersNum;var a=!this._loaded;if(this._loaded=!0,this.fire("viewreset",{hard:!i}),a)this.fire("load"),this.eachLayer(this._layerAdd,this);if(this.fire("move"),s||o)this.fire("zoomend");this.fire("moveend",{hard:!i})},_rawPanBy:function(i){t.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(i))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_updateZoomLevels:function(){var i,e=1/0,o=-(1/0),s=this._getZoomSpan();for(i in this._zoomBoundLayers){var t=this._zoomBoundLayers[i];if(!isNaN(t.options.minZoom))e=Math.min(e,t.options.minZoom);if(!isNaN(t.options.maxZoom))o=Math.max(o,t.options.maxZoom)}if(i===n)this._layersMaxZoom=this._layersMinZoom=n;else this._layersMaxZoom=o,this._layersMinZoom=e;if(s!==this._getZoomSpan())this.fire("zoomlevelschange")},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(i){if(!t.DomEvent)return;i=i||"on",t.DomEvent[i](this._container,"click",this._onMouseClick,this);var o=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"],n,s;for(n=0,s=o.length;s>n;n++)t.DomEvent[i](this._container,o[n],this._fireMouseEvent,this);if(this.options.trackResize)t.DomEvent[i](e,"resize",this._onResize,this)},_onResize:function(){t.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=t.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this,!1,this._container)},_onMouseClick:function(i){if(!this._loaded||!i._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved())||t.DomEvent._skipped(i))return;this.fire("preclick"),this._fireMouseEvent(i)},_fireMouseEvent:function(e){if(!this._loaded||t.DomEvent._skipped(e))return;var i=e.type;if(i="mouseenter"===i?"mouseover":"mouseleave"===i?"mouseout":i,!this.hasEventListeners(i))return;if("contextmenu"===i)t.DomEvent.preventDefault(e);var n=this.mouseEventToContainerPoint(e),o=this.containerPointToLayerPoint(n),s=this.layerPointToLatLng(o);this.fire(i,{latlng:s,layerPoint:o,containerPoint:n,originalEvent:e})},_onTileLayerLoad:function(){if(this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad)this.fire("tilelayersload")},_clearHandlers:function(){for(var t=0,i=this._handlers.length;i>t;t++)this._handlers[t].disable()},whenReady:function(t,i){if(this._loaded)t.call(i||this,this);else this.on("load",t,i);return this},_layerAdd:function(t){t.onAdd(this),this.fire("layeradd",{layer:t})},_getMapPanePos:function(){return t.DomUtil.getPosition(this._mapPane)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(t,i){var e=this.getSize()._divideBy(2);return this.project(t,i)._subtract(e)._round()},_latLngToNewLayerPoint:function(i,t,e){var n=this._getNewTopLeftPoint(e,t).add(this._getMapPanePos());return this.project(i,t)._subtract(n)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(n,i,o){if(!o)return n;var e=this.project(n,i),s=this.getSize().divideBy(2),a=new t.Bounds(e.subtract(s),e.add(s)),r=this._getBoundsOffset(a,o,i);return this.unproject(e.add(r),i)},_limitOffset:function(i,e){if(!e)return i;var n=this.getPixelBounds(),o=new t.Bounds(n.min.add(i),n.max.add(i));return i.add(this._getBoundsOffset(o,e))},_getBoundsOffset:function(i,e,n){var o=this.project(e.getNorthWest(),n).subtract(i.min),s=this.project(e.getSouthEast(),n).subtract(i.max),a=this._rebound(o.x,-s.x),r=this._rebound(o.y,-s.y);return new t.Point(a,r)},_rebound:function(t,i){return t+i>0?Math.round(t-i)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(i))},_limitZoom:function(t){var i=this.getMinZoom(),e=this.getMaxZoom();return Math.max(i,Math.min(e,t))}}),t.map=function(i,e){return new t.Map(i,e);
},t.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.314245179,R_MAJOR:6378137,project:function(o){var a=t.LatLng.DEG_TO_RAD,s=this.MAX_LATITUDE,u=Math.max(Math.min(s,o.lat),-s),n=this.R_MAJOR,l=this.R_MINOR,f=o.lng*a*n,i=u*a,r=l/n,h=Math.sqrt(1-r*r),e=h*Math.sin(i);e=Math.pow((1-e)/(1+e),.5*h);var c=Math.tan(.5*(.5*Math.PI-i))/e;return i=-n*Math.log(c),new t.Point(f,i)},unproject:function(s){for(var h=t.LatLng.RAD_TO_DEG,n=this.R_MAJOR,p=this.R_MINOR,u=s.x*h/n,a=p/n,r=Math.sqrt(1-a*a),l=Math.exp(-s.y/n),i=Math.PI/2-2*Math.atan(l),c=15,f=1e-7,d=c,o=.1,e;Math.abs(o)>f&&--d>0;)e=r*Math.sin(i),o=Math.PI/2-2*Math.atan(l*Math.pow((1-e)/(1+e),.5*r))-i,i+=o;return new t.LatLng(i*h,u)}},t.CRS.EPSG3395=t.extend({},t.CRS,{code:"EPSG:3395",projection:t.Projection.Mercator,transformation:function(){var e=t.Projection.Mercator,n=e.R_MAJOR,i=.5/(Math.PI*n);return new t.Transformation(i,.5,-i,.5)}()}),t.TileLayer=t.Class.extend({includes:t.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:t.Browser.mobile,updateWhenIdle:t.Browser.mobile},initialize:function(n,i){if(i=t.setOptions(this,i),i.detectRetina&&t.Browser.retina&&i.maxZoom>0){if(i.tileSize=Math.floor(i.tileSize/2),i.zoomOffset++,i.minZoom>0)i.minZoom--;this.options.maxZoom--}if(i.bounds)i.bounds=t.latLngBounds(i.bounds);this._url=n;var e=this.options.subdomains;if("string"==typeof e)this.options.subdomains=e.split("")},onAdd:function(i){if(this._map=i,this._animated=i._zoomAnimated,this._initContainer(),i.on({viewreset:this._reset,moveend:this._update},this),this._animated)i.on({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this);if(!this.options.updateWhenIdle)this._limitedUpdate=t.Util.limitExecByInterval(this._update,150,this),i.on("move",this._limitedUpdate,this);this._reset(),this._update()},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){if(this._container.parentNode.removeChild(this._container),t.off({viewreset:this._reset,moveend:this._update},this),this._animated)t.off({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this);if(!this.options.updateWhenIdle)t.off("move",this._limitedUpdate,this);this._container=null,this._map=null},bringToFront:function(){var t=this._map._panes.tilePane;if(this._container)t.appendChild(this._container),this._setAutoZIndex(t,Math.max);return this},bringToBack:function(){var t=this._map._panes.tilePane;if(this._container)t.insertBefore(this._container,t.firstChild),this._setAutoZIndex(t,Math.min);return this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(t){if(this.options.opacity=t,this._map)this._updateOpacity();return this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},setUrl:function(t,i){if(this._url=t,!i)this.redraw();return this},redraw:function(){if(this._map)this._reset({hard:!0}),this._update();return this},_updateZIndex:function(){if(this._container&&this.options.zIndex!==n)this._container.style.zIndex=this.options.zIndex},_setAutoZIndex:function(a,e){var n=a.children,i=-e(1/0,-(1/0)),o,t,s;for(t=0,s=n.length;s>t;t++)if(n[t]!==this._container)if(o=parseInt(n[t].style.zIndex,10),!isNaN(o))i=e(i,o);this.options.zIndex=this._container.style.zIndex=(isFinite(i)?i:0)+e(1,-1)},_updateOpacity:function(){var i,e=this._tiles;if(t.Browser.ielt9)for(i in e)t.DomUtil.setOpacity(e[i],this.options.opacity);else t.DomUtil.setOpacity(this._container,this.options.opacity)},_initContainer:function(){var e=this._map._panes.tilePane;if(!this._container){if(this._container=t.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._animated){var i="leaflet-tile-container";this._bgBuffer=t.DomUtil.create("div",i,this._container),this._tileContainer=t.DomUtil.create("div",i,this._container)}else this._tileContainer=this._container;if(e.appendChild(this._container),this.options.opacity<1)this._updateOpacity()}},_reset:function(t){for(var i in this._tiles)this.fire("tileunload",{tile:this._tiles[i]});if(this._tiles={},this._tilesToLoad=0,this.options.reuseTiles)this._unusedTiles=[];if(this._tileContainer.innerHTML="",this._animated&&t&&t.hard)this._clearBgBuffer();this._initContainer()},_getTileSize:function(){var t=this._map,n=t.getZoom()+this.options.zoomOffset,i=this.options.maxNativeZoom,e=this.options.tileSize;if(i&&n>i)e=Math.round(t.getZoomScale(n)/t.getZoomScale(i)*e);return e},_update:function(){if(!this._map)return;var i=this._map,e=i.getPixelBounds(),n=i.getZoom(),o=this._getTileSize();if(n>this.options.maxZoom||n<this.options.minZoom)return;var s=t.bounds(e.min.divideBy(o)._floor(),e.max.divideBy(o)._floor());if(this._addTilesFromCenterOut(s),this.options.unloadInvisibleTiles||this.options.reuseTiles)this._removeOtherTiles(s)},_addTilesFromCenterOut:function(n){var o=[],h=n.getCenter(),s,e,a;for(s=n.min.y;s<=n.max.y;s++)for(e=n.min.x;e<=n.max.x;e++)if(a=new t.Point(e,s),this._tileShouldBeLoaded(a))o.push(a);var r=o.length;if(0===r)return;o.sort(function(t,i){return t.distanceTo(h)-i.distanceTo(h)});var l=i.createDocumentFragment();if(!this._tilesToLoad)this.fire("loading");for(this._tilesToLoad+=r,e=0;r>e;e++)this._addTile(o[e],l);this._tileContainer.appendChild(l)},_tileShouldBeLoaded:function(t){if(t.x+":"+t.y in this._tiles)return!1;var i=this.options;if(!i.continuousWorld){var s=this._getWrapTileNum();if(i.noWrap&&(t.x<0||t.x>=s.x)||t.y<0||t.y>=s.y)return!1}if(i.bounds){var e=i.tileSize,a=t.multiplyBy(e),r=a.add([e,e]),n=this._map.unproject(a),o=this._map.unproject(r);if(!i.continuousWorld&&!i.noWrap)n=n.wrap(),o=o.wrap();if(!i.bounds.intersects([n,o]))return!1}return!0},_removeOtherTiles:function(t){var i,e,n,o;for(o in this._tiles)if(i=o.split(":"),e=parseInt(i[0],10),n=parseInt(i[1],10),e<t.min.x||e>t.max.x||n<t.min.y||n>t.max.y)this._removeTile(o)},_removeTile:function(e){var i=this._tiles[e];if(this.fire("tileunload",{tile:i,url:i.src}),this.options.reuseTiles)t.DomUtil.removeClass(i,"leaflet-tile-loaded"),this._unusedTiles.push(i);else if(i.parentNode===this._tileContainer)this._tileContainer.removeChild(i);if(!t.Browser.android)i.onload=null,i.src=t.Util.emptyImageUrl;delete this._tiles[e]},_addTile:function(e,n){var o=this._getTilePos(e),i=this._getTile();if(t.DomUtil.setPosition(i,o,t.Browser.chrome),this._tiles[e.x+":"+e.y]=i,this._loadTile(i,e),i.parentNode!==this._tileContainer)n.appendChild(i)},_getZoomForUrl:function(){var t=this.options,i=this._map.getZoom();if(t.zoomReverse)i=t.maxZoom-i;return i+=t.zoomOffset,t.maxNativeZoom?Math.min(i,t.maxNativeZoom):i},_getTilePos:function(t){var i=this._map.getPixelOrigin(),e=this._getTileSize();return t.multiplyBy(e).subtract(i)},getTileUrl:function(i){return t.Util.template(this._url,t.extend({s:this._getSubdomain(i),z:i.z,x:i.x,y:i.y},this.options))},_getWrapTileNum:function(){var t=this._map.options.crs,i=t.getSize(this._map.getZoom());return i.divideBy(this._getTileSize())._floor()},_adjustTilePoint:function(t){var i=this._getWrapTileNum();if(!this.options.continuousWorld&&!this.options.noWrap)t.x=(t.x%i.x+i.x)%i.x;if(this.options.tms)t.y=i.y-t.y-1;t.z=this._getZoomForUrl()},_getSubdomain:function(t){var i=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[i]},_getTile:function(){if(this.options.reuseTiles&&this._unusedTiles.length>0){var t=this._unusedTiles.pop();return this._resetTile(t),t}return this._createTile()},_resetTile:function(){},_createTile:function(){var i=t.DomUtil.create("img","leaflet-tile");if(i.style.width=i.style.height=this._getTileSize()+"px",i.galleryimg="no",i.onselectstart=i.onmousemove=t.Util.falseFn,t.Browser.ielt9&&this.options.opacity!==n)t.DomUtil.setOpacity(i,this.options.opacity);if(t.Browser.mobileWebkit3d)i.style.WebkitBackfaceVisibility="hidden";return i},_loadTile:function(t,i){t._layer=this,t.onload=this._tileOnLoad,t.onerror=this._tileOnError,this._adjustTilePoint(i),t.src=this.getTileUrl(i),this.fire("tileloadstart",{tile:t,url:t.src})},_tileLoaded:function(){if(this._tilesToLoad--,this._animated)t.DomUtil.addClass(this._tileContainer,"leaflet-zoom-animated");if(!this._tilesToLoad)if(this.fire("load"),this._animated)clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(t.bind(this._clearBgBuffer,this),500)},_tileOnLoad:function(){var i=this._layer;if(this.src!==t.Util.emptyImageUrl)t.DomUtil.addClass(this,"leaflet-tile-loaded"),i.fire("tileload",{tile:this,url:this.src});i._tileLoaded()},_tileOnError:function(){var t=this._layer;t.fire("tileerror",{tile:this,url:this.src});var i=t.options.errorTileUrl;if(i)this.src=i;t._tileLoaded()}}),t.tileLayer=function(i,e){return new t.TileLayer(i,e)},t.TileLayer.WMS=t.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(s,e){this._url=s;var i=t.extend({},this.defaultWmsParams),o=e.tileSize||this.options.tileSize;if(e.detectRetina&&t.Browser.retina)i.width=i.height=2*o;else i.width=i.height=o;for(var n in e)if(!this.options.hasOwnProperty(n)&&"crs"!==n)i[n]=e[n];this.wmsParams=i,t.setOptions(this,e)},onAdd:function(i){this._crs=this.options.crs||i.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,t.TileLayer.prototype.onAdd.call(this,i)},getTileUrl:function(i){var s=this._map,o=this.options.tileSize,a=i.multiplyBy(o),h=a.add([o,o]),e=this._crs.project(s.unproject(a,i.z)),n=this._crs.project(s.unproject(h,i.z)),l=this._wmsVersion>=1.3&&this._crs===t.CRS.EPSG4326?[n.y,e.x,e.y,n.x].join(","):[e.x,n.y,n.x,e.y].join(","),r=t.Util.template(this._url,{s:this._getSubdomain(i)});return r+t.Util.getParamString(this.wmsParams,r,!0)+"&BBOX="+l},setParams:function(i,e){if(t.extend(this.wmsParams,i),!e)this.redraw();return this}}),t.tileLayer.wms=function(i,e){return new t.TileLayer.WMS(i,e)},t.TileLayer.Canvas=t.TileLayer.extend({options:{async:!1},initialize:function(i){t.setOptions(this,i)},redraw:function(){if(this._map)this._reset({hard:!0}),this._update();for(var t in this._tiles)this._redrawTile(this._tiles[t]);return this},_redrawTile:function(t){this.drawTile(t,t._tilePoint,this._map._zoom)},_createTile:function(){var i=t.DomUtil.create("canvas","leaflet-tile");return i.width=i.height=this.options.tileSize,i.onselectstart=i.onmousemove=t.Util.falseFn,i},_loadTile:function(t,i){if(t._layer=this,t._tilePoint=i,this._redrawTile(t),!this.options.async)this.tileDrawn(t)},drawTile:function(){},tileDrawn:function(t){this._tileOnLoad.call(t)}}),t.tileLayer.canvas=function(i){return new t.TileLayer.Canvas(i)},t.ImageOverlay=t.Class.extend({includes:t.Mixin.Events,options:{opacity:1},initialize:function(i,e,n){this._url=i,this._bounds=t.latLngBounds(e),t.setOptions(this,n)},onAdd:function(i){if(this._map=i,!this._image)this._initImage();if(i._panes.overlayPane.appendChild(this._image),i.on("viewreset",this._reset,this),i.options.zoomAnimation&&t.Browser.any3d)i.on("zoomanim",this._animateZoom,this);this._reset()},onRemove:function(t){if(t.getPanes().overlayPane.removeChild(this._image),t.off("viewreset",this._reset,this),t.options.zoomAnimation)t.off("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},bringToFront:function(){if(this._image)this._map._panes.overlayPane.appendChild(this._image);return this},bringToBack:function(){var t=this._map._panes.overlayPane;if(this._image)t.insertBefore(this._image,t.firstChild);return this},setUrl:function(t){this._url=t,this._image.src=this._url},getAttribution:function(){return this.options.attribution},_initImage:function(){if(this._image=t.DomUtil.create("img","leaflet-image-layer"),this._map.options.zoomAnimation&&t.Browser.any3d)t.DomUtil.addClass(this._image,"leaflet-zoom-animated");else t.DomUtil.addClass(this._image,"leaflet-zoom-hide");this._updateOpacity(),t.extend(this._image,{galleryimg:"no",onselectstart:t.Util.falseFn,onmousemove:t.Util.falseFn,onload:t.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(i){var e=this._map,s=this._image,n=e.getZoomScale(i.zoom),a=this._bounds.getNorthWest(),r=this._bounds.getSouthEast(),o=e._latLngToNewLayerPoint(a,i.zoom,i.center),h=e._latLngToNewLayerPoint(r,i.zoom,i.center)._subtract(o),l=o._add(h._multiplyBy(.5*(1-1/n)));s.style[t.DomUtil.TRANSFORM]=t.DomUtil.getTranslateString(l)+" scale("+n+") "},_reset:function(){var i=this._image,e=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),n=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(e);t.DomUtil.setPosition(i,e),i.style.width=n.x+"px",i.style.height=n.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){t.DomUtil.setOpacity(this._image,this.options.opacity)}}),t.imageOverlay=function(i,e,n){return new t.ImageOverlay(i,e,n)},t.Icon=t.Class.extend({options:{className:""},initialize:function(i){t.setOptions(this,i)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(i,e){var n=this._getIconUrl(i);if(!n){if("icon"===i)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var t;if(!e||"IMG"!==e.tagName)t=this._createImg(n);else t=this._createImg(n,e);return this._setIconStyles(t,i),t},_setIconStyles:function(e,s){var n=this.options,o=t.point(n[s+"Size"]),i;if("shadow"===s)i=t.point(n.shadowAnchor||n.iconAnchor);else i=t.point(n.iconAnchor);if(!i&&o)i=o.divideBy(2,!0);if(e.className="leaflet-marker-"+s+" "+n.className,i)e.style.marginLeft=-i.x+"px",e.style.marginTop=-i.y+"px";if(o)e.style.width=o.x+"px",e.style.height=o.y+"px"},_createImg:function(e,t){return t=t||i.createElement("img"),t.src=e,t},_getIconUrl:function(i){if(t.Browser.retina&&this.options[i+"RetinaUrl"])return this.options[i+"RetinaUrl"];return this.options[i+"Url"]}}),t.icon=function(i){return new t.Icon(i)},t.Icon.Default=t.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(i){var e=i+"Url";if(this.options[e])return this.options[e];if(t.Browser.retina&&"icon"===i)i+="-2x";var n=t.Icon.Default.imagePath;if(!n)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return n+"/marker-"+i+".png"}}),t.Icon.Default.imagePath=function(){var o=i.getElementsByTagName("script"),s=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/,t,a,e,r,n;for(t=0,a=o.length;a>t;t++)if(e=o[t].src,r=e.match(s))return n=e.split(s)[0],(n?n+"/":"")+"images"}(),t.Marker=t.Class.extend({includes:t.Mixin.Events,options:{icon:new t.Icon.Default,title:"",alt:"",clickable:!0,draggable:!1,keyboard:!0,zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250},initialize:function(i,e){t.setOptions(this,e),this._latlng=t.latLng(i)},onAdd:function(t){if(this._map=t,t.on("viewreset",this.update,this),this._initIcon(),this.update(),this.fire("add"),t.options.zoomAnimation&&t.options.markerZoomAnimation)t.on("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){if(this.dragging)this.dragging.disable();this._removeIcon(),this._removeShadow(),this.fire("remove"),t.off({viewreset:this.update,zoomanim:this._animateZoom},this),this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(i){return this._latlng=t.latLng(i),this.update(),this.fire("move",{latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update(),this},setIcon:function(t){if(this.options.icon=t,this._map)this._initIcon(),this.update();if(this._popup)this.bindPopup(this._popup);return this},update:function(){if(this._icon){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var i=this.options,o=this._map,l=o.options.zoomAnimation&&o.options.markerZoomAnimation,s=l?"leaflet-zoom-animated":"leaflet-zoom-hide",e=i.icon.createIcon(this._icon),a=!1;if(e!==this._icon){if(this._icon)this._removeIcon();if(a=!0,i.title)e.title=i.title;if(i.alt)e.alt=i.alt}if(t.DomUtil.addClass(e,s),i.keyboard)e.tabIndex="0";if(this._icon=e,this._initInteraction(),i.riseOnHover)t.DomEvent.on(e,"mouseover",this._bringToFront,this).on(e,"mouseout",this._resetZIndex,this);var n=i.icon.createShadow(this._shadow),r=!1;if(n!==this._shadow)this._removeShadow(),r=!0;if(n)t.DomUtil.addClass(n,s);if(this._shadow=n,i.opacity<1)this._updateOpacity();var h=this._map._panes;if(a)h.markerPane.appendChild(this._icon);if(n&&r)h.shadowPane.appendChild(this._shadow)},_removeIcon:function(){if(this.options.riseOnHover)t.DomEvent.off(this._icon,"mouseover",this._bringToFront).off(this._icon,"mouseout",this._resetZIndex);this._map._panes.markerPane.removeChild(this._icon),this._icon=null},_removeShadow:function(){if(this._shadow)this._map._panes.shadowPane.removeChild(this._shadow);this._shadow=null},_setPos:function(i){if(t.DomUtil.setPosition(this._icon,i),this._shadow)t.DomUtil.setPosition(this._shadow,i);this._zIndex=i.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var i=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(i)},_initInteraction:function(){if(!this.options.clickable)return;var i=this._icon,n=["dblclick","mousedown","mouseover","mouseout","contextmenu"];t.DomUtil.addClass(i,"leaflet-clickable"),t.DomEvent.on(i,"click",this._onMouseClick,this),t.DomEvent.on(i,"keypress",this._onKeyPress,this);for(var e=0;e<n.length;e++)t.DomEvent.on(i,n[e],this._fireMouseEvent,this);if(t.Handler.MarkerDrag)if(this.dragging=new t.Handler.MarkerDrag(this),this.options.draggable)this.dragging.enable()},_onMouseClick:function(i){var e=this.dragging&&this.dragging.moved();if(this.hasEventListeners(i.type)||e)t.DomEvent.stopPropagation(i);if(e)return;if((!this.dragging||!this.dragging._enabled)&&this._map.dragging&&this._map.dragging.moved())return;this.fire(i.type,{originalEvent:i,latlng:this._latlng})},_onKeyPress:function(t){if(13===t.keyCode)this.fire("click",{originalEvent:t,latlng:this._latlng})},_fireMouseEvent:function(i){if(this.fire(i.type,{originalEvent:i,latlng:this._latlng}),"contextmenu"===i.type&&this.hasEventListeners(i.type))t.DomEvent.preventDefault(i);if("mousedown"!==i.type)t.DomEvent.stopPropagation(i);else t.DomEvent.preventDefault(i)},setOpacity:function(t){if(this.options.opacity=t,this._map)this._updateOpacity();return this},_updateOpacity:function(){if(t.DomUtil.setOpacity(this._icon,this.options.opacity),this._shadow)t.DomUtil.setOpacity(this._shadow,this.options.opacity)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),t.marker=function(i,e){return new t.Marker(i,e)},t.DivIcon=t.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(n){var t=n&&"DIV"===n.tagName?n:i.createElement("div"),e=this.options;if(e.html!==!1)t.innerHTML=e.html;else t.innerHTML="";if(e.bgPos)t.style.backgroundPosition=-e.bgPos.x+"px "+-e.bgPos.y+"px";return this._setIconStyles(t,"icon"),t},createShadow:function(){return null}}),t.divIcon=function(i){return new t.DivIcon(i)},t.Map.mergeOptions({closePopupOnClick:!0}),t.Popup=t.Class.extend({includes:t.Mixin.Events,options:{minWidth:50,maxWidth:300,autoPan:!0,closeButton:!0,offset:[0,7],autoPanPadding:[5,5],keepInView:!1,className:"",zoomAnimation:!0},initialize:function(i,e){t.setOptions(this,i),this._source=e,this._animated=t.Browser.any3d&&this.options.zoomAnimation,this._isOpen=!1},onAdd:function(i){if(this._map=i,!this._container)this._initLayout();var e=i.options.fadeAnimation;if(e)t.DomUtil.setOpacity(this._container,0);if(i._panes.popupPane.appendChild(this._container),i.on(this._getEvents(),this),this.update(),e)t.DomUtil.setOpacity(this._container,1);if(this.fire("open"),i.fire("popupopen",{popup:this}),this._source)this._source.fire("popupopen",{popup:this})},addTo:function(t){return t.addLayer(this),this},openOn:function(t){return t.openPopup(this),this},onRemove:function(i){if(i._panes.popupPane.removeChild(this._container),t.Util.falseFn(this._container.offsetWidth),i.off(this._getEvents(),this),i.options.fadeAnimation)t.DomUtil.setOpacity(this._container,0);if(this._map=null,this.fire("close"),i.fire("popupclose",{popup:this}),this._source)this._source.fire("popupclose",{popup:this})},getLatLng:function(){return this._latlng},setLatLng:function(i){if(this._latlng=t.latLng(i),this._map)this._updatePosition(),this._adjustPan();return this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},update:function(){if(!this._map)return;this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan()},_getEvents:function(){var t={viewreset:this._updatePosition};if(this._animated)t.zoomanim=this._zoomAnimation;if("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)t.preclick=this._close;if(this.options.keepInView)t.moveend=this._adjustPan;return t},_close:function(){if(this._map)this._map.closePopup(this)},_initLayout:function(){var i="leaflet-popup",s=i+" "+this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"),n=this._container=t.DomUtil.create("div",s),e;if(this.options.closeButton)e=this._closeButton=t.DomUtil.create("a",i+"-close-button",n),e.href="#close",e.innerHTML="&#215;",t.DomEvent.disableClickPropagation(e),t.DomEvent.on(e,"click",this._onCloseButtonClick,this);var o=this._wrapper=t.DomUtil.create("div",i+"-content-wrapper",n);t.DomEvent.disableClickPropagation(o),this._contentNode=t.DomUtil.create("div",i+"-content",o),t.DomEvent.disableScrollPropagation(this._contentNode),t.DomEvent.on(o,"contextmenu",t.DomEvent.stopPropagation),this._tipContainer=t.DomUtil.create("div",i+"-tip-container",n),this._tip=t.DomUtil.create("div",i+"-tip",this._tipContainer)},_updateContent:function(){if(!this._content)return;if("string"==typeof this._content)this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")},_updateLayout:function(){var e=this._contentNode,i=e.style;i.width="",i.whiteSpace="nowrap";var n=e.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),i.width=n+1+"px",i.whiteSpace="",i.height="";var a=e.offsetHeight,o=this.options.maxHeight,s="leaflet-popup-scrolled";if(o&&a>o)i.height=o+"px",t.DomUtil.addClass(e,s);else t.DomUtil.removeClass(e,s);this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(!this._map)return;var i=this._map.latLngToLayerPoint(this._latlng),e=this._animated,n=t.point(this.options.offset);if(e)t.DomUtil.setPosition(this._container,i);this._containerBottom=-n.y-(e?0:i.y),this._containerLeft=-Math.round(this._containerWidth/2)+n.x+(e?0:i.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"},_zoomAnimation:function(i){var e=this._map._latLngToNewLayerPoint(this._latlng,i.zoom,i.center);t.DomUtil.setPosition(this._container,e)},_adjustPan:function(){if(!this.options.autoPan)return;var r=this._map,h=this._container.offsetHeight,u=this._containerWidth,l=new t.Point(this._containerLeft,-h-this._containerBottom);if(this._animated)l._add(t.DomUtil.getPosition(this._container));var i=r.layerPointToContainerPoint(l),c=t.point(this.options.autoPanPadding),s=t.point(this.options.autoPanPaddingTopLeft||c),a=t.point(this.options.autoPanPaddingBottomRight||c),o=r.getSize(),n=0,e=0;if(i.x+u+a.x>o.x)n=i.x+u-o.x+a.x;if(i.x-n-s.x<0)n=i.x-s.x;if(i.y+h+a.y>o.y)e=i.y+h-o.y+a.y;if(i.y-e-s.y<0)e=i.y-s.y;if(n||e)r.fire("autopanstart").panBy([n,e])},_onCloseButtonClick:function(i){this._close(),t.DomEvent.stop(i)}}),t.popup=function(i,e){return new t.Popup(i,e)},t.Map.include({openPopup:function(i,e,n){if(this.closePopup(),!(i instanceof t.Popup)){var o=i;i=new t.Popup(n).setLatLng(e).setContent(o)}return i._isOpen=!0,this._popup=i,this.addLayer(i)},closePopup:function(t){if(!t||t===this._popup)t=this._popup,this._popup=null;if(t)this.removeLayer(t),t._isOpen=!1;return this}}),t.Marker.include({openPopup:function(){if(this._popup&&this._map&&!this._map.hasLayer(this._popup))this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup);return this},closePopup:function(){if(this._popup)this._popup._close();return this},togglePopup:function(){if(this._popup)if(this._popup._isOpen)this.closePopup();else this.openPopup();return this},bindPopup:function(n,i){var e=t.point(this.options.icon.options.popupAnchor||[0,0]);if(e=e.add(t.Popup.prototype.options.offset),i&&i.offset)e=e.add(i.offset);if(i=t.extend({offset:e},i),!this._popupHandlersAdded)this.on("click",this.togglePopup,this).on("remove",this.closePopup,this).on("move",this._movePopup,this),this._popupHandlersAdded=!0;if(n instanceof t.Popup)t.setOptions(n,i),this._popup=n;else this._popup=new t.Popup(i,this).setContent(n);return this},setPopupContent:function(t){if(this._popup)this._popup.setContent(t);return this},unbindPopup:function(){if(this._popup)this._popup=null,this.off("click",this.togglePopup,this).off("remove",this.closePopup,this).off("move",this._movePopup,this),this._popupHandlersAdded=!1;return this},getPopup:function(){return this._popup},_movePopup:function(t){this._popup.setLatLng(t.latlng)}}),t.LayerGroup=t.Class.extend({initialize:function(i){this._layers={};var t,e;if(i)for(t=0,e=i.length;e>t;t++)this.addLayer(i[t])},addLayer:function(t){var i=this.getLayerId(t);if(this._layers[i]=t,this._map)this._map.addLayer(t);return this},removeLayer:function(t){var i=t in this._layers?t:this.getLayerId(t);if(this._map&&this._layers[i])this._map.removeLayer(this._layers[i]);return delete this._layers[i],this},hasLayer:function(t){if(!t)return!1;return t in this._layers||this.getLayerId(t)in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(i){var n=Array.prototype.slice.call(arguments,1),e,t;for(e in this._layers)if(t=this._layers[e],t[i])t[i].apply(t,n);return this},onAdd:function(t){this._map=t,this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t),this._map=null},addTo:function(t){return t.addLayer(this),this},eachLayer:function(t,i){for(var e in this._layers)t.call(i,this._layers[e]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var i in this._layers)t.push(this._layers[i]);return t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(i){return t.stamp(i)}}),t.layerGroup=function(i){return new t.LayerGroup(i)},t.FeatureGroup=t.LayerGroup.extend({includes:t.Mixin.Events,statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"},addLayer:function(i){if(this.hasLayer(i))return this;if("on"in i)i.on(t.FeatureGroup.EVENTS,this._propagateEvent,this);if(t.LayerGroup.prototype.addLayer.call(this,i),this._popupContent&&i.bindPopup)i.bindPopup(this._popupContent,this._popupOptions);return this.fire("layeradd",{layer:i})},removeLayer:function(i){if(!this.hasLayer(i))return this;if(i in this._layers)i=this._layers[i];if(i.off(t.FeatureGroup.EVENTS,this._propagateEvent,this),t.LayerGroup.prototype.removeLayer.call(this,i),this._popupContent)this.invoke("unbindPopup");return this.fire("layerremove",{layer:i})},bindPopup:function(t,i){return this._popupContent=t,this._popupOptions=i,this.invoke("bindPopup",t,i)},openPopup:function(t){for(var i in this._layers){this._layers[i].openPopup(t);break}return this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var i=new t.LatLngBounds;return this.eachLayer(function(e){i.extend(e instanceof t.Marker?e.getLatLng():e.getBounds())}),i},_propagateEvent:function(i){i=t.extend({layer:i.target,target:this},i),this.fire(i.type,i)}}),t.featureGroup=function(i){return new t.FeatureGroup(i)},t.Path=t.Class.extend({includes:[t.Mixin.Events],statics:{CLIP_PADDING:function(){var i=t.Browser.mobile?1280:2e3,n=(i/Math.max(e.outerWidth,e.outerHeight)-1)/2;return Math.max(0,Math.min(.5,n))}()},options:{stroke:!0,color:"#0033ff",dashArray:null,lineCap:null,lineJoin:null,weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0},initialize:function(i){t.setOptions(this,i)},onAdd:function(t){if(this._map=t,!this._container)this._initElements(),this._initEvents();if(this.projectLatlngs(),this._updatePath(),this._container)this._map._pathRoot.appendChild(this._container);this.fire("add"),t.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(i){if(i._pathRoot.removeChild(this._container),this.fire("remove"),this._map=null,t.Browser.vml)this._container=null,this._stroke=null,this._fill=null;i.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(i){if(t.setOptions(this,i),this._container)this._updateStyle();return this},redraw:function(){if(this._map)this.projectLatlngs(),this._updatePath();return this}}),t.Map.include({_updatePathViewport:function(){var i=t.Path.CLIP_PADDING,e=this.getSize(),o=t.DomUtil.getPosition(this._mapPane),n=o.multiplyBy(-1)._subtract(e.multiplyBy(i)._round()),s=n.add(e.multiplyBy(1+2*i)._round());this._pathViewport=new t.Bounds(n,s)}}),t.Path.SVG_NS="http://www.w3.org/2000/svg",t.Browser.svg=!(!i.createElementNS||!i.createElementNS(t.Path.SVG_NS,"svg").createSVGRect),t.Path=t.Path.extend({statics:{SVG:t.Browser.svg},bringToFront:function(){var i=this._map._pathRoot,t=this._container;if(t&&i.lastChild!==t)i.appendChild(t);return this},bringToBack:function(){var i=this._map._pathRoot,t=this._container,e=i.firstChild;if(t&&e!==t)i.insertBefore(t,e);return this},getPathString:function(){},_createElement:function(e){return i.createElementNS(t.Path.SVG_NS,e)},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){if(this._container=this._createElement("g"),this._path=this._createElement("path"),this.options.className)t.DomUtil.addClass(this._path,this.options.className);this._container.appendChild(this._path)},_initStyle:function(){if(this.options.stroke)this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round");if(this.options.fill)this._path.setAttribute("fill-rule","evenodd");if(this.options.pointerEvents)this._path.setAttribute("pointer-events",this.options.pointerEvents);if(!this.options.clickable&&!this.options.pointerEvents)this._path.setAttribute("pointer-events","none");this._updateStyle()},_updateStyle:function(){if(this.options.stroke){if(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray)this._path.setAttribute("stroke-dasharray",this.options.dashArray);else this._path.removeAttribute("stroke-dasharray");if(this.options.lineCap)this._path.setAttribute("stroke-linecap",this.options.lineCap);if(this.options.lineJoin)this._path.setAttribute("stroke-linejoin",this.options.lineJoin)}else this._path.setAttribute("stroke","none");if(this.options.fill)this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity);else this._path.setAttribute("fill","none")},_updatePath:function(){var t=this.getPathString();if(!t)t="M0 0";
this._path.setAttribute("d",t)},_initEvents:function(){if(this.options.clickable){if(t.Browser.svg||!t.Browser.vml)t.DomUtil.addClass(this._path,"leaflet-clickable");t.DomEvent.on(this._container,"click",this._onMouseClick,this);for(var e=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"],i=0;i<e.length;i++)t.DomEvent.on(this._container,e[i],this._fireMouseEvent,this)}},_onMouseClick:function(t){if(this._map.dragging&&this._map.dragging.moved())return;this._fireMouseEvent(t)},_fireMouseEvent:function(i){if(!this.hasEventListeners(i.type))return;var e=this._map,n=e.mouseEventToContainerPoint(i),o=e.containerPointToLayerPoint(n),s=e.layerPointToLatLng(o);if(this.fire(i.type,{latlng:s,layerPoint:o,containerPoint:n,originalEvent:i}),"contextmenu"===i.type)t.DomEvent.preventDefault(i);if("mousemove"!==i.type)t.DomEvent.stopPropagation(i)}}),t.Map.include({_initPathRoot:function(){if(!this._pathRoot){if(this._pathRoot=t.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&t.Browser.any3d)t.DomUtil.addClass(this._pathRoot,"leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom});else t.DomUtil.addClass(this._pathRoot,"leaflet-zoom-hide");this.on("moveend",this._updateSvgViewport),this._updateSvgViewport()}},_animatePathZoom:function(i){var e=this.getZoomScale(i.zoom),n=this._getCenterOffset(i.center)._multiplyBy(-e)._add(this._pathViewport.min);this._pathRoot.style[t.DomUtil.TRANSFORM]=t.DomUtil.getTranslateString(n)+" scale("+e+") ",this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(this._pathZooming)return;this._updatePathViewport();var n=this._pathViewport,e=n.min,o=n.max,s=o.x-e.x,a=o.y-e.y,i=this._pathRoot,r=this._panes.overlayPane;if(t.Browser.mobileWebkit)r.removeChild(i);if(t.DomUtil.setPosition(i,e),i.setAttribute("width",s),i.setAttribute("height",a),i.setAttribute("viewBox",[e.x,e.y,s,a].join(" ")),t.Browser.mobileWebkit)r.appendChild(i)}}),t.Path.include({bindPopup:function(i,e){if(i instanceof t.Popup)this._popup=i;else{if(!this._popup||e)this._popup=new t.Popup(e,this);this._popup.setContent(i)}if(!this._popupHandlersAdded)this.on("click",this._openPopup,this).on("remove",this.closePopup,this),this._popupHandlersAdded=!0;return this},unbindPopup:function(){if(this._popup)this._popup=null,this.off("click",this._openPopup).off("remove",this.closePopup),this._popupHandlersAdded=!1;return this},openPopup:function(t){if(this._popup)t=t||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:t});return this},closePopup:function(){if(this._popup)this._popup._close();return this},_openPopup:function(t){this._popup.setLatLng(t.latlng),this._map.openPopup(this._popup)}}),t.Browser.vml=!t.Browser.svg&&function(){try{var e=i.createElement("div");e.innerHTML='<v:shape adj="1"/>';var t=e.firstChild;return t.style.behavior="url(#default#VML)",t&&"object"==typeof t.adj}catch(n){return!1}}(),t.Path=t.Browser.svg||!t.Browser.vml?t.Path:t.Path.extend({statics:{VML:!0,CLIP_PADDING:.02},_createElement:function(){try{return i.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return i.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return i.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var i=this._container=this._createElement("shape");if(t.DomUtil.addClass(i,"leaflet-vml-shape"+(this.options.className?" "+this.options.className:"")),this.options.clickable)t.DomUtil.addClass(i,"leaflet-clickable");i.coordsize="1 1",this._path=this._createElement("path"),i.appendChild(this._path),this._map._pathRoot.appendChild(i)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var e=this._stroke,n=this._fill,i=this.options,o=this._container;if(o.stroked=i.stroke,o.filled=i.fill,i.stroke){if(!e)e=this._stroke=this._createElement("stroke"),e.endcap="round",o.appendChild(e);if(e.weight=i.weight+"px",e.color=i.color,e.opacity=i.opacity,i.dashArray)e.dashStyle=t.Util.isArray(i.dashArray)?i.dashArray.join(" "):i.dashArray.replace(/( *, *)/g," ");else e.dashStyle="";if(i.lineCap)e.endcap=i.lineCap.replace("butt","flat");if(i.lineJoin)e.joinstyle=i.lineJoin}else if(e)o.removeChild(e),this._stroke=null;if(i.fill){if(!n)n=this._fill=this._createElement("fill"),o.appendChild(n);n.color=i.fillColor||i.color,n.opacity=i.fillOpacity}else if(n)o.removeChild(n),this._fill=null},_updatePath:function(){var t=this._container.style;t.display="none",this._path.v=this.getPathString()+" ",t.display=""}}),t.Map.include(t.Browser.svg||!t.Browser.vml?{}:{_initPathRoot:function(){if(this._pathRoot)return;var t=this._pathRoot=i.createElement("div");t.className="leaflet-vml-container",this._panes.overlayPane.appendChild(t),this.on("moveend",this._updatePathViewport),this._updatePathViewport()}}),t.Browser.canvas=function(){return!!i.createElement("canvas").getContext}(),t.Path=t.Path.SVG&&!e.L_PREFER_CANVAS||!t.Browser.canvas?t.Path:t.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){if(this._map)this.projectLatlngs(),this._requestUpdate();return this},setStyle:function(i){if(t.setOptions(this,i),this._map)this._updateStyle(),this._requestUpdate();return this},onRemove:function(t){if(t.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this),this.options.clickable)this._map.off("click",this._onClick,this),this._map.off("mousemove",this._onMouseMove,this);this._requestUpdate(),this.fire("remove"),this._map=null},_requestUpdate:function(){if(this._map&&!t.Path._updateRequest)t.Path._updateRequest=t.Util.requestAnimFrame(this._fireMapMoveEnd,this._map)},_fireMapMoveEnd:function(){t.Path._updateRequest=null,this.fire("moveend")},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){var t=this.options;if(t.stroke)this._ctx.lineWidth=t.weight,this._ctx.strokeStyle=t.color;if(t.fill)this._ctx.fillStyle=t.fillColor||t.color},_drawPath:function(){var i,e,o,s,n,a;for(this._ctx.beginPath(),i=0,o=this._parts.length;o>i;i++){for(e=0,s=this._parts[i].length;s>e;e++)n=this._parts[i][e],a=(0===e?"move":"line")+"To",this._ctx[a](n.x,n.y);if(this instanceof t.Polygon)this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(this._checkIfEmpty())return;var t=this._ctx,i=this.options;if(this._drawPath(),t.save(),this._updateStyle(),i.fill)t.globalAlpha=i.fillOpacity,t.fill();if(i.stroke)t.globalAlpha=i.opacity,t.stroke();t.restore()},_initEvents:function(){if(this.options.clickable)this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onClick,this)},_onClick:function(t){if(this._containsPoint(t.layerPoint))this.fire("click",t)},_onMouseMove:function(t){if(!this._map||this._map._animatingZoom)return;if(this._containsPoint(t.layerPoint))this._ctx.canvas.style.cursor="pointer",this._mouseInside=!0,this.fire("mouseover",t);else if(this._mouseInside)this._ctx.canvas.style.cursor="",this._mouseInside=!1,this.fire("mouseout",t)}}),t.Map.include(t.Path.SVG&&!e.L_PREFER_CANVAS||!t.Browser.canvas?{}:{_initPathRoot:function(){var t=this._pathRoot,e;if(!t){if(t=this._pathRoot=i.createElement("canvas"),t.style.position="absolute",e=this._canvasCtx=t.getContext("2d"),e.lineCap="round",e.lineJoin="round",this._panes.overlayPane.appendChild(t),this.options.zoomAnimation)this._pathRoot.className="leaflet-zoom-animated",this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom);this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport()}},_updateCanvasViewport:function(){if(this._pathZooming)return;this._updatePathViewport();var n=this._pathViewport,i=n.min,o=n.max.subtract(i),e=this._pathRoot;t.DomUtil.setPosition(e,i),e.width=o.x,e.height=o.y,e.getContext("2d").translate(-i.x,-i.y)}}),t.LineUtil={simplify:function(t,i){if(!i||!t.length)return t.slice();var e=i*i;return t=this._reducePoints(t,e),t=this._simplifyDP(t,e)},pointToSegmentDistance:function(t,i,e){return Math.sqrt(this._sqClosestPointOnSegment(t,i,e,!0))},closestPointOnSegment:function(t,i,e){return this._sqClosestPointOnSegment(t,i,e)},_simplifyDP:function(o,a){var i=o.length,r=typeof Uint8Array!=n+""?Uint8Array:Array,e=new r(i);e[0]=e[i-1]=1,this._simplifyDPStep(o,e,a,0,i-1);var t,s=[];for(t=0;i>t;t++)if(e[t])s.push(o[t]);return s},_simplifyDPStep:function(t,n,o,s,a){var r=0,e,i,h;for(i=s+1;a-1>=i;i++)if(h=this._sqClosestPointOnSegment(t[i],t[s],t[a],!0),h>r)e=i,r=h;if(r>o)n[e]=1,this._simplifyDPStep(t,n,o,s,e),this._simplifyDPStep(t,n,o,e,a)},_reducePoints:function(t,s){for(var e=[t[0]],i=1,n=0,o=t.length;o>i;i++)if(this._sqDist(t[i],t[n])>s)e.push(t[i]),n=i;if(o-1>n)e.push(t[o-1]);return e},clipSegment:function(e,n,o,h){var t=h?this._lastCode:this._getBitCode(e,o),i=this._getBitCode(n,o),a,s,r;for(this._lastCode=i;;)if(!(t|i))return[e,n];else if(t&i)return!1;else if(a=t||i,s=this._getEdgeIntersection(e,n,a,o),r=this._getBitCode(s,o),a===t)e=s,t=r;else n=s,i=r},_getEdgeIntersection:function(i,r,e,h){var n=r.x-i.x,o=r.y-i.y,s=h.min,a=h.max;if(8&e)return new t.Point(i.x+n*(a.y-i.y)/o,a.y);else if(4&e)return new t.Point(i.x+n*(s.y-i.y)/o,s.y);else if(2&e)return new t.Point(a.x,i.y+o*(a.x-i.x)/n);else if(1&e)return new t.Point(s.x,i.y+o*(s.x-i.x)/n)},_getBitCode:function(i,e){var t=0;if(i.x<e.min.x)t|=1;else if(i.x>e.max.x)t|=2;if(i.y<e.min.y)t|=4;else if(i.y>e.max.y)t|=8;return t},_sqDist:function(t,i){var e=i.x-t.x,n=i.y-t.y;return e*e+n*n},_sqClosestPointOnSegment:function(a,h,r,u){var n=h.x,o=h.y,i=r.x-n,e=r.y-o,l=i*i+e*e,s;if(l>0)if(s=((a.x-n)*i+(a.y-o)*e)/l,s>1)n=r.x,o=r.y;else if(s>0)n+=i*s,o+=e*s;return i=a.x-n,e=a.y-o,u?i*i+e*e:new t.Point(n,o)}},t.Polyline=t.Path.extend({initialize:function(i,e){t.Path.prototype.initialize.call(this,e),this._latlngs=this._convertLatLngs(i)},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var t=0,i=this._latlngs.length;i>t;t++)this._originalPoints[t]=this._map.latLngToLayerPoint(this._latlngs[t])},getPathString:function(){for(var t=0,e=this._parts.length,i="";e>t;t++)i+=this._getPathPartStr(this._parts[t]);return i},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._latlngs=this._convertLatLngs(t),this.redraw()},addLatLng:function(i){return this._latlngs.push(t.latLng(i)),this.redraw()},spliceLatLngs:function(){var t=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs,!0),this.redraw(),t},closestLayerPoint:function(h){for(var a=1/0,l=this._parts,o,s,i=null,n=0,c=l.length;c>n;n++)for(var r=l[n],e=1,f=r.length;f>e;e++){o=r[e-1],s=r[e];var u=t.LineUtil._sqClosestPointOnSegment(h,o,s,!0);if(a>u)a=u,i=t.LineUtil._sqClosestPointOnSegment(h,o,s)}if(i)i.distance=Math.sqrt(a);return i},getBounds:function(){return new t.LatLngBounds(this.getLatLngs())},_convertLatLngs:function(e,s){var i,n,o=s?e:[];for(i=0,n=e.length;n>i;i++){if(t.Util.isArray(e[i])&&"number"!=typeof e[i][0])return;o[i]=t.latLng(e[i])}return o},_initEvents:function(){t.Path.prototype._initEvents.call(this)},_getPathPartStr:function(n){for(var s=t.Path.VML,i=0,a=n.length,o="",e;a>i;i++){if(e=n[i],s)e._round();o+=(i?"L":"M")+e.x+" "+e.y}return o},_clipPoints:function(){var n=this._originalPoints,a=n.length,i,e,o;if(this.options.noClip)return void(this._parts=[n]);this._parts=[];var s=this._parts,r=this._map._pathViewport,h=t.LineUtil;for(i=0,e=0;a-1>i;i++){if(o=h.clipSegment(n[i],n[i+1],r,i),!o)continue;if(s[e]=s[e]||[],s[e].push(o[0]),o[1]!==n[i+1]||i===a-2)s[e].push(o[1]),e++}},_simplifyPoints:function(){for(var e=this._parts,n=t.LineUtil,i=0,o=e.length;o>i;i++)e[i]=n.simplify(e[i],this.options.smoothFactor)},_updatePath:function(){if(!this._map)return;this._clipPoints(),this._simplifyPoints(),t.Path.prototype._updatePath.call(this)}}),t.polyline=function(i,e){return new t.Polyline(i,e)},t.PolyUtil={},t.PolyUtil.clipPolygon=function(e,r){var s,d=[1,4,2,8],i,f,c,h,l,u,o,n,a=t.LineUtil;for(i=0,u=e.length;u>i;i++)e[i]._code=a._getBitCode(e[i],r);for(c=0;4>c;c++){for(o=d[c],s=[],i=0,u=e.length,f=u-1;u>i;f=i++)if(h=e[i],l=e[f],!(h._code&o)){if(l._code&o)n=a._getEdgeIntersection(l,h,o,r),n._code=a._getBitCode(n,r),s.push(n);s.push(h)}else if(!(l._code&o))n=a._getEdgeIntersection(l,h,o,r),n._code=a._getBitCode(n,r),s.push(n);e=s}return e},t.Polygon=t.Polyline.extend({options:{fill:!0},initialize:function(i,e){t.Polyline.prototype.initialize.call(this,i,e),this._initWithHoles(i)},_initWithHoles:function(i){var e,o,n;if(i&&t.Util.isArray(i[0])&&"number"!=typeof i[0][0])for(this._latlngs=this._convertLatLngs(i[0]),this._holes=i.slice(1),e=0,o=this._holes.length;o>e;e++)if(n=this._holes[e]=this._convertLatLngs(this._holes[e]),n[0].equals(n[n.length-1]))n.pop();if(i=this._latlngs,i.length>=2&&i[0].equals(i[i.length-1]))i.pop()},projectLatlngs:function(){if(t.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],!this._holes)return;var i,e,n,o;for(i=0,n=this._holes.length;n>i;i++)for(this._holePoints[i]=[],e=0,o=this._holes[i].length;o>e;e++)this._holePoints[i][e]=this._map.latLngToLayerPoint(this._holes[i][e])},setLatLngs:function(i){if(i&&t.Util.isArray(i[0])&&"number"!=typeof i[0][0])return this._initWithHoles(i),this.redraw();else return t.Polyline.prototype.setLatLngs.call(this,i)},_clipPoints:function(){var o=this._originalPoints,e=[];if(this._parts=[o].concat(this._holePoints),this.options.noClip)return;for(var i=0,s=this._parts.length;s>i;i++){var n=t.PolyUtil.clipPolygon(this._parts[i],this._map._pathViewport);if(n.length)e.push(n)}this._parts=e},_getPathPartStr:function(i){var e=t.Polyline.prototype._getPathPartStr.call(this,i);return e+(t.Browser.svg?"z":"x")}}),t.polygon=function(i,e){return new t.Polygon(i,e)},function(){function createMulti(i){return t.FeatureGroup.extend({initialize:function(t,i){this._layers={},this._options=i,this.setLatLngs(t)},setLatLngs:function(e){var t=0,n=e.length;for(this.eachLayer(function(i){if(n>t)i.setLatLngs(e[t++]);else this.removeLayer(i)},this);n>t;)this.addLayer(new i(e[t++],this._options));return this},getLatLngs:function(){var t=[];return this.eachLayer(function(i){t.push(i.getLatLngs())}),t}})}t.MultiPolyline=createMulti(t.Polyline),t.MultiPolygon=createMulti(t.Polygon),t.multiPolyline=function(i,e){return new t.MultiPolyline(i,e)},t.multiPolygon=function(i,e){return new t.MultiPolygon(i,e)}}(),t.Rectangle=t.Polygon.extend({initialize:function(i,e){t.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(i),e)},setBounds:function(t){this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(i){return i=t.latLngBounds(i),[i.getSouthWest(),i.getNorthWest(),i.getNorthEast(),i.getSouthEast()]}}),t.rectangle=function(i,e){return new t.Rectangle(i,e)},t.Circle=t.Path.extend({initialize:function(i,e,n){t.Path.prototype.initialize.call(this,n),this._latlng=t.latLng(i),this._mRadius=e},options:{fill:!0},setLatLng:function(i){return this._latlng=t.latLng(i),this.redraw()},setRadius:function(t){return this._mRadius=t,this.redraw()},projectLatlngs:function(){var i=this._getLngRadius(),t=this._latlng,e=this._map.latLngToLayerPoint([t.lat,t.lng-i]);this._point=this._map.latLngToLayerPoint(t),this._radius=Math.max(this._point.x-e.x,1)},getBounds:function(){var e=this._getLngRadius(),n=this._mRadius/40075017*360,i=this._latlng;return new t.LatLngBounds([i.lat-n,i.lng-e],[i.lat+n,i.lng+e])},getLatLng:function(){return this._latlng},getPathString:function(){var e=this._point,i=this._radius;if(this._checkIfEmpty())return"";if(t.Browser.svg)return"M"+e.x+","+(e.y-i)+"A"+i+","+i+",0,1,1,"+(e.x-.1)+","+(e.y-i)+" z";else return e._round(),i=Math.round(i),"AL "+e.x+","+e.y+" "+i+","+i+" 0,23592600"},getRadius:function(){return this._mRadius},_getLatRadius:function(){return this._mRadius/40075017*360},_getLngRadius:function(){return this._getLatRadius()/Math.cos(t.LatLng.DEG_TO_RAD*this._latlng.lat)},_checkIfEmpty:function(){if(!this._map)return!1;var t=this._map._pathViewport,i=this._radius,e=this._point;return e.x-i>t.max.x||e.y-i>t.max.y||e.x+i<t.min.x||e.y+i<t.min.y}}),t.circle=function(i,e,n){return new t.Circle(i,e,n)},t.CircleMarker=t.Circle.extend({options:{radius:10,weight:2},initialize:function(i,e){t.Circle.prototype.initialize.call(this,i,null,e),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_updateStyle:function(){t.Circle.prototype._updateStyle.call(this),this.setRadius(this.options.radius)},setLatLng:function(i){if(t.Circle.prototype.setLatLng.call(this,i),this._popup&&this._popup._isOpen)this._popup.setLatLng(i);return this},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius}}),t.circleMarker=function(i,e){return new t.CircleMarker(i,e)},t.Polyline.include(!t.Path.CANVAS?{}:{_containsPoint:function(l,u){var e,i,o,a,s,r,n,h=this.options.weight/2;if(t.Browser.touch)h+=10;for(e=0,a=this._parts.length;a>e;e++)for(n=this._parts[e],i=0,s=n.length,o=s-1;s>i;o=i++){if(!u&&0===i)continue;if(r=t.LineUtil.pointToSegmentDistance(l,n[o],n[i]),h>=r)return!0}return!1}}),t.Polygon.include(!t.Path.CANVAS?{}:{_containsPoint:function(e){var r=!1,n,i,o,s,a,h,u,l;if(t.Polyline.prototype._containsPoint.call(this,e,!0))return!0;for(s=0,u=this._parts.length;u>s;s++)for(n=this._parts[s],a=0,l=n.length,h=l-1;l>a;h=a++)if(i=n[a],o=n[h],i.y>e.y!=o.y>e.y&&e.x<(o.x-i.x)*(e.y-i.y)/(o.y-i.y)+i.x)r=!r;return r}}),t.Circle.include(!t.Path.CANVAS?{}:{_drawPath:function(){var t=this._point;this._ctx.beginPath(),this._ctx.arc(t.x,t.y,this._radius,0,2*Math.PI,!1)},_containsPoint:function(t){var i=this._point,e=this.options.stroke?this.options.weight/2:0;return t.distanceTo(i)<=this._radius+e}}),t.CircleMarker.include(!t.Path.CANVAS?{}:{_updateStyle:function(){t.Path.prototype._updateStyle.call(this)}}),t.GeoJSON=t.FeatureGroup.extend({initialize:function(i,e){if(t.setOptions(this,e),this._layers={},i)this.addData(i)},addData:function(i){var a=t.Util.isArray(i)?i:i.features,o,r,s;if(a){for(o=0,r=a.length;r>o;o++)if(s=a[o],s.geometries||s.geometry||s.features||s.coordinates)this.addData(a[o]);return this}var e=this.options;if(e.filter&&!e.filter(i))return;var n=t.GeoJSON.geometryToLayer(i,e.pointToLayer,e.coordsToLatLng,e);if(n.feature=t.GeoJSON.asFeature(i),n.defaultOptions=n.options,this.resetStyle(n),e.onEachFeature)e.onEachFeature(i,n);return this.addLayer(n)},resetStyle:function(i){var e=this.options.style;if(e)t.Util.extend(i.options,i.defaultOptions),this._setLayerStyle(i,e)},setStyle:function(t){this.eachLayer(function(i){this._setLayerStyle(i,t)},this)},_setLayerStyle:function(i,t){if("function"==typeof t)t=t(i.feature);if(i.setStyle)i.setStyle(t)}}),t.extend(t.GeoJSON,{geometryToLayer:function(s,r,e,h){var u="Feature"===s.type?s.geometry:s,i=u.coordinates,l=[],a,o,n,c;switch(e=e||this.coordsToLatLng,u.type){case"Point":return a=e(i),r?r(s,a):new t.Marker(a);case"MultiPoint":for(n=0,c=i.length;c>n;n++)a=e(i[n]),l.push(r?r(s,a):new t.Marker(a));return new t.FeatureGroup(l);case"LineString":return o=this.coordsToLatLngs(i,0,e),new t.Polyline(o,h);case"Polygon":if(2===i.length&&!i[1].length)throw new Error("Invalid GeoJSON object.");return o=this.coordsToLatLngs(i,1,e),new t.Polygon(o,h);case"MultiLineString":return o=this.coordsToLatLngs(i,1,e),new t.MultiPolyline(o,h);case"MultiPolygon":return o=this.coordsToLatLngs(i,2,e),new t.MultiPolygon(o,h);case"GeometryCollection":for(n=0,c=u.geometries.length;c>n;n++)l.push(this.geometryToLayer({geometry:u.geometries[n],type:"Feature",properties:s.properties},r,e,h));return new t.FeatureGroup(l);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(i){return new t.LatLng(i[1],i[0],i[2])},coordsToLatLngs:function(i,e,n){var o,t,s,a=[];for(t=0,s=i.length;s>t;t++)o=e?this.coordsToLatLngs(i[t],e-1,n):(n||this.coordsToLatLng)(i[t]),a.push(o);return a},latLngToCoords:function(t){var i=[t.lng,t.lat];if(t.alt!==n)i.push(t.alt);return i},latLngsToCoords:function(e){for(var n=[],i=0,o=e.length;o>i;i++)n.push(t.GeoJSON.latLngToCoords(e[i]));return n},getFeature:function(i,e){return i.feature?t.extend({},i.feature,{geometry:e}):t.GeoJSON.asFeature(e)},asFeature:function(t){if("Feature"===t.type)return t;return{type:"Feature",properties:{},geometry:t}}});var s={toGeoJSON:function(){return t.GeoJSON.getFeature(this,{type:"Point",coordinates:t.GeoJSON.latLngToCoords(this.getLatLng())})}};if(t.Marker.include(s),t.Circle.include(s),t.CircleMarker.include(s),t.Polyline.include({toGeoJSON:function(){return t.GeoJSON.getFeature(this,{type:"LineString",coordinates:t.GeoJSON.latLngsToCoords(this.getLatLngs())})}}),t.Polygon.include({toGeoJSON:function(){var i=[t.GeoJSON.latLngsToCoords(this.getLatLngs())],e,o,n;if(i[0].push(i[0][0]),this._holes)for(e=0,o=this._holes.length;o>e;e++)n=t.GeoJSON.latLngsToCoords(this._holes[e]),n.push(n[0]),i.push(n);return t.GeoJSON.getFeature(this,{type:"Polygon",coordinates:i})}}),function(){function multiToGeoJSON(i){return function(){var e=[];return this.eachLayer(function(t){e.push(t.toGeoJSON().geometry.coordinates)}),t.GeoJSON.getFeature(this,{type:i,coordinates:e})}}t.MultiPolyline.include({toGeoJSON:multiToGeoJSON("MultiLineString")}),t.MultiPolygon.include({toGeoJSON:multiToGeoJSON("MultiPolygon")}),t.LayerGroup.include({toGeoJSON:function(){var i=this.feature&&this.feature.geometry,e=[],n;if(i&&"MultiPoint"===i.type)return multiToGeoJSON("MultiPoint").call(this);var o=i&&"GeometryCollection"===i.type;if(this.eachLayer(function(i){if(i.toGeoJSON)n=i.toGeoJSON(),e.push(o?n.geometry:t.GeoJSON.asFeature(n))}),o)return t.GeoJSON.getFeature(this,{geometries:e,type:"GeometryCollection"});return{type:"FeatureCollection",features:e}}})}(),t.geoJson=function(i,e){return new t.GeoJSON(i,e)},t.DomEvent={addListener:function(i,n,a,l){var s=t.stamp(a),r="_leaflet_"+n+s,e,o,h;if(i[r])return this;if(e=function(e){return a.call(l||i,e||t.DomEvent._getEvent())},t.Browser.pointer&&0===n.indexOf("touch"))return this.addPointerListener(i,n,e,s);if(t.Browser.touch&&"dblclick"===n&&this.addDoubleTapListener)this.addDoubleTapListener(i,e,s);if("addEventListener"in i)if("mousewheel"===n)i.addEventListener("DOMMouseScroll",e,!1),i.addEventListener(n,e,!1);else if("mouseenter"===n||"mouseleave"===n)o=e,h="mouseenter"===n?"mouseover":"mouseout",e=function(e){if(!t.DomEvent._checkMouse(i,e))return;return o(e)},i.addEventListener(h,e,!1);else if("click"===n&&t.Browser.android)o=e,e=function(i){return t.DomEvent._filterClick(i,o)},i.addEventListener(n,e,!1);else i.addEventListener(n,e,!1);else if("attachEvent"in i)i.attachEvent("on"+n,e);return i[r]=e,this},removeListener:function(i,e,a){var o=t.stamp(a),s="_leaflet_"+e+o,n=i[s];if(!n)return this;if(t.Browser.pointer&&0===e.indexOf("touch"))this.removePointerListener(i,e,o);else if(t.Browser.touch&&"dblclick"===e&&this.removeDoubleTapListener)this.removeDoubleTapListener(i,o);else if("removeEventListener"in i)if("mousewheel"===e)i.removeEventListener("DOMMouseScroll",n,!1),i.removeEventListener(e,n,!1);else if("mouseenter"===e||"mouseleave"===e)i.removeEventListener("mouseenter"===e?"mouseover":"mouseout",n,!1);else i.removeEventListener(e,n,!1);else if("detachEvent"in i)i.detachEvent("on"+e,n);return i[s]=null,this},stopPropagation:function(i){if(i.stopPropagation)i.stopPropagation();else i.cancelBubble=!0;return t.DomEvent._skipped(i),this},disableScrollPropagation:function(i){var e=t.DomEvent.stopPropagation;return t.DomEvent.on(i,"mousewheel",e).on(i,"MozMousePixelScroll",e)},disableClickPropagation:function(i){for(var n=t.DomEvent.stopPropagation,e=t.Draggable.START.length-1;e>=0;e--)t.DomEvent.on(i,t.Draggable.START[e],n);return t.DomEvent.on(i,"click",t.DomEvent._fakeStop).on(i,"dblclick",n)},preventDefault:function(t){if(t.preventDefault)t.preventDefault();else t.returnValue=!1;return this},stop:function(i){return t.DomEvent.preventDefault(i).stopPropagation(i)},getMousePosition:function(i,e){if(!e)return new t.Point(i.clientX,i.clientY);var n=e.getBoundingClientRect();return new t.Point(i.clientX-n.left-e.clientLeft,i.clientY-n.top-e.clientTop)},getWheelDelta:function(t){var i=0;if(t.wheelDelta)i=t.wheelDelta/120;if(t.detail)i=-t.detail/3;return i},_skipEvents:{},_fakeStop:function(i){t.DomEvent._skipEvents[i.type]=!0},_skipped:function(t){var i=this._skipEvents[t.type];return this._skipEvents[t.type]=!1,i},_checkMouse:function(i,e){var t=e.relatedTarget;if(!t)return!0;try{for(;t&&t!==i;)t=t.parentNode}catch(n){return!1}return t!==i},_getEvent:function(){var t=e.event;if(!t)for(var i=arguments.callee.caller;i&&(t=i.arguments[0],!t||e.Event!==t.constructor);)i=i.caller;return t},_filterClick:function(i,o){var n=i.timeStamp||i.originalEvent.timeStamp,e=t.DomEvent._lastClick&&n-t.DomEvent._lastClick;if(e&&e>100&&500>e||i.target._simulatedClick&&!i._simulated)return void t.DomEvent.stop(i);return t.DomEvent._lastClick=n,o(i)}},t.DomEvent.on=t.DomEvent.addListener,t.DomEvent.off=t.DomEvent.removeListener,t.Draggable=t.Class.extend({includes:t.Mixin.Events,statics:{START:t.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(t,i){this._element=t,this._dragStartTarget=i||t},enable:function(){if(this._enabled)return;for(var i=t.Draggable.START.length-1;i>=0;i--)t.DomEvent.on(this._dragStartTarget,t.Draggable.START[i],this._onDown,this);this._enabled=!0},disable:function(){if(!this._enabled)return;for(var i=t.Draggable.START.length-1;i>=0;i--)t.DomEvent.off(this._dragStartTarget,t.Draggable.START[i],this._onDown,this);this._enabled=!1,this._moved=!1},_onDown:function(e){if(this._moved=!1,e.shiftKey||1!==e.which&&1!==e.button&&!e.touches)return;if(t.DomEvent.stopPropagation(e),t.Draggable._disabled)return;if(t.DomUtil.disableImageDrag(),t.DomUtil.disableTextSelection(),this._moving)return;var n=e.touches?e.touches[0]:e;this._startPoint=new t.Point(n.clientX,n.clientY),this._startPos=this._newPos=t.DomUtil.getPosition(this._element),t.DomEvent.on(i,t.Draggable.MOVE[e.type],this._onMove,this).on(i,t.Draggable.END[e.type],this._onUp,this)},_onMove:function(e){if(e.touches&&e.touches.length>1)return void(this._moved=!0);var o=e.touches&&1===e.touches.length?e.touches[0]:e,s=new t.Point(o.clientX,o.clientY),n=s.subtract(this._startPoint);if(!n.x&&!n.y)return;if(t.Browser.touch&&Math.abs(n.x)+Math.abs(n.y)<3)return;if(t.DomEvent.preventDefault(e),!this._moved)this.fire("dragstart"),this._moved=!0,this._startPos=t.DomUtil.getPosition(this._element).subtract(n),t.DomUtil.addClass(i.body,"leaflet-dragging"),this._lastTarget=e.target||e.srcElement,t.DomUtil.addClass(this._lastTarget,"leaflet-drag-target");this._newPos=this._startPos.add(n),this._moving=!0,t.Util.cancelAnimFrame(this._animRequest),this._animRequest=t.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)},_updatePosition:function(){this.fire("predrag"),t.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(){if(t.DomUtil.removeClass(i.body,"leaflet-dragging"),this._lastTarget)t.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null;for(var e in t.Draggable.MOVE)t.DomEvent.off(i,t.Draggable.MOVE[e],this._onMove).off(i,t.Draggable.END[e],this._onUp);if(t.DomUtil.enableImageDrag(),t.DomUtil.enableTextSelection(),this._moved&&this._moving)t.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)});this._moving=!1}}),t.Handler=t.Class.extend({initialize:function(t){this._map=t},enable:function(){if(this._enabled)return;this._enabled=!0,this.addHooks()},disable:function(){if(!this._enabled)return;this._enabled=!1,this.removeHooks()},enabled:function(){return!!this._enabled}}),t.Map.mergeOptions({dragging:!0,inertia:!t.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,inertiaThreshold:t.Browser.touch?32:18,easeLinearity:.25,worldCopyJump:!1}),t.Map.Drag=t.Handler.extend({addHooks:function(){if(!this._draggable){var i=this._map;if(this._draggable=new t.Draggable(i._mapPane,i._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),i.options.worldCopyJump)this._draggable.on("predrag",this._onPreDrag,this),i.on("viewreset",this._onViewReset,this),i.whenReady(this._onViewReset,this)}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var t=this._map;if(t._panAnim)t._panAnim.stop();if(t.fire("movestart").fire("dragstart"),t.options.inertia)this._positions=[],this._times=[]},_onDrag:function(){if(this._map.options.inertia){var t=this._lastTime=+new Date,i=this._lastPos=this._draggable._newPos;if(this._positions.push(i),this._times.push(t),t-this._times[0]>200)this._positions.shift(),this._times.shift()}this._map.fire("move").fire("drag")},_onViewReset:function(){var t=this._map.getSize()._divideBy(2),i=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=i.subtract(t).x,this._worldWidth=this._map.project([0,180]).x},_onPreDrag:function(){var e=this._worldWidth,i=Math.round(e/2),t=this._initialWorldOffset,n=this._draggable._newPos.x,o=(n-i+t)%e+i-t,s=(n+i+t)%e-i-t,a=Math.abs(o+t)<Math.abs(s+t)?o:s;this._draggable._newPos.x=a},_onDragEnd:function(p){var i=this._map,n=i.options,s=+new Date-this._lastTime,u=!n.inertia||s>n.inertiaThreshold||!this._positions[0];if(i.fire("dragend",p),u)i.fire("moveend");else{var c=this._lastPos.subtract(this._positions[0]),f=(this._lastTime+s-this._times[0])/1e3,o=n.easeLinearity,a=c.multiplyBy(o/f),r=a.distanceTo([0,0]),h=Math.min(n.inertiaMaxSpeed,r),d=a.multiplyBy(h/r),l=h/(n.inertiaDeceleration*o),e=d.multiplyBy(-l/2).round();if(!e.x||!e.y)i.fire("moveend");else e=i._limitOffset(e,i.options.maxBounds),t.Util.requestAnimFrame(function(){i.panBy(e,{duration:l,easeLinearity:o,noMoveStart:!0})})}}}),t.Map.addInitHook("addHandler","dragging",t.Map.Drag),t.Map.mergeOptions({doubleClickZoom:!0}),t.Map.DoubleClickZoom=t.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(i){var t=this._map,e=t.getZoom()+(i.originalEvent.shiftKey?-1:1);if("center"===t.options.doubleClickZoom)t.setZoom(e);else t.setZoomAround(i.containerPoint,e)}}),t.Map.addInitHook("addHandler","doubleClickZoom",t.Map.DoubleClickZoom),t.Map.mergeOptions({scrollWheelZoom:!0}),t.Map.ScrollWheelZoom=t.Handler.extend({addHooks:function(){t.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),t.DomEvent.on(this._map._container,"MozMousePixelScroll",t.DomEvent.preventDefault),this._delta=0},removeHooks:function(){t.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll),t.DomEvent.off(this._map._container,"MozMousePixelScroll",t.DomEvent.preventDefault)},_onWheelScroll:function(i){var e=t.DomEvent.getWheelDelta(i);if(this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(i),!this._startTime)this._startTime=+new Date;var n=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(t.bind(this._performZoom,this),n),t.DomEvent.preventDefault(i),t.DomEvent.stopPropagation(i)},_performZoom:function(){var i=this._map,t=this._delta,e=i.getZoom();if(t=t>0?Math.ceil(t):Math.floor(t),t=Math.max(Math.min(t,4),-4),t=i._limitZoom(e+t)-e,this._delta=0,this._startTime=null,!t)return;if("center"===i.options.scrollWheelZoom)i.setZoom(e+t);else i.setZoomAround(this._lastMousePos,e+t)}}),t.Map.addInitHook("addHandler","scrollWheelZoom",t.Map.ScrollWheelZoom),t.extend(t.DomEvent,{_touchstart:t.Browser.msPointer?"MSPointerDown":t.Browser.pointer?"pointerdown":"touchstart",
_touchend:t.Browser.msPointer?"MSPointerUp":t.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(n,f,a){function onTouchStart(i){var n;if(t.Browser.pointer)o.push(i.pointerId),n=o.length;else n=i.touches.length;if(n>1)return;var a=Date.now(),h=a-(s||a);e=i.touches?i.touches[0]:i,r=h>0&&d>=h,s=a}function onTouchEnd(l){if(t.Browser.pointer){var h=o.indexOf(l.pointerId);if(-1===h)return;o.splice(h,1)}if(r){if(t.Browser.pointer){var n={},i;for(var a in e)if(i=e[a],"function"==typeof i)n[a]=i.bind(e);else n[a]=i;e=n}e.type="dblclick",f(e),s=null}}var s,r=!1,d=250,e,l="_leaflet_",u=this._touchstart,c=this._touchend,o=[];n[l+u+a]=onTouchStart,n[l+c+a]=onTouchEnd;var h=t.Browser.pointer?i.documentElement:n;if(n.addEventListener(u,onTouchStart,!1),h.addEventListener(c,onTouchEnd,!1),t.Browser.pointer)h.addEventListener(t.DomEvent.POINTER_CANCEL,onTouchEnd,!1);return this},removeDoubleTapListener:function(e,n){var o="_leaflet_";if(e.removeEventListener(this._touchstart,e[o+this._touchstart+n],!1),(t.Browser.pointer?i.documentElement:e).removeEventListener(this._touchend,e[o+this._touchend+n],!1),t.Browser.pointer)i.documentElement.removeEventListener(t.DomEvent.POINTER_CANCEL,e[o+this._touchend+n],!1);return this}}),t.extend(t.DomEvent,{POINTER_DOWN:t.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:t.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:t.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:t.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:[],_pointerDocumentListener:!1,addPointerListener:function(i,t,e,n){switch(t){case"touchstart":return this.addPointerListenerStart(i,t,e,n);case"touchend":return this.addPointerListenerEnd(i,t,e,n);case"touchmove":return this.addPointerListenerMove(i,t,e,n);default:throw"Unknown touch event type"}},addPointerListenerStart:function(n,l,a,r){var h="_leaflet_",e=this._pointers,o=function(i){t.DomEvent.preventDefault(i);for(var o=!1,n=0;n<e.length;n++)if(e[n].pointerId===i.pointerId){o=!0;break}if(!o)e.push(i);i.touches=e.slice(),i.changedTouches=[i],a(i)};if(n[h+"touchstart"+r]=o,n.addEventListener(this.POINTER_DOWN,o,!1),!this._pointerDocumentListener){var s=function(i){for(var t=0;t<e.length;t++)if(e[t].pointerId===i.pointerId){e.splice(t,1);break}};i.documentElement.addEventListener(this.POINTER_UP,s,!1),i.documentElement.addEventListener(this.POINTER_CANCEL,s,!1),this._pointerDocumentListener=!0}return this},addPointerListenerMove:function(i,s,e,n){function cb(i){if((i.pointerType===i.MSPOINTER_TYPE_MOUSE||"mouse"===i.pointerType)&&0===i.buttons)return;for(var n=0;n<t.length;n++)if(t[n].pointerId===i.pointerId){t[n]=i;break}i.touches=t.slice(),i.changedTouches=[i],e(i)}var o="_leaflet_",t=this._pointers;return i[o+"touchmove"+n]=cb,i.addEventListener(this.POINTER_MOVE,cb,!1),this},addPointerListenerEnd:function(i,a,n,o){var s="_leaflet_",t=this._pointers,e=function(i){for(var e=0;e<t.length;e++)if(t[e].pointerId===i.pointerId){t.splice(e,1);break}i.touches=t.slice(),i.changedTouches=[i],n(i)};return i[s+"touchend"+o]=e,i.addEventListener(this.POINTER_UP,e,!1),i.addEventListener(this.POINTER_CANCEL,e,!1),this},removePointerListener:function(t,e,n){var o="_leaflet_",i=t[o+e+n];switch(e){case"touchstart":t.removeEventListener(this.POINTER_DOWN,i,!1);break;case"touchmove":t.removeEventListener(this.POINTER_MOVE,i,!1);break;case"touchend":t.removeEventListener(this.POINTER_UP,i,!1),t.removeEventListener(this.POINTER_CANCEL,i,!1)}return this}}),t.Map.mergeOptions({touchZoom:t.Browser.touch&&!t.Browser.android23,bounceAtZoomLimits:!0}),t.Map.TouchZoom=t.Handler.extend({addHooks:function(){t.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){t.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(n){var e=this._map;if(!n.touches||2!==n.touches.length||e._animatingZoom||this._zooming)return;var o=e.mouseEventToLayerPoint(n.touches[0]),s=e.mouseEventToLayerPoint(n.touches[1]),a=e._getCenterLayerPoint();if(this._startCenter=o.add(s)._divideBy(2),this._startDist=o.distanceTo(s),this._moved=!1,this._zooming=!0,this._centerOffset=a.subtract(this._startCenter),e._panAnim)e._panAnim.stop();t.DomEvent.on(i,"touchmove",this._onTouchMove,this).on(i,"touchend",this._onTouchEnd,this),t.DomEvent.preventDefault(n)},_onTouchMove:function(e){var i=this._map;if(!e.touches||2!==e.touches.length||!this._zooming)return;var n=i.mouseEventToLayerPoint(e.touches[0]),o=i.mouseEventToLayerPoint(e.touches[1]);if(this._scale=n.distanceTo(o)/this._startDist,this._delta=n._add(o)._divideBy(2)._subtract(this._startCenter),1===this._scale)return;if(!i.options.bounceAtZoomLimits)if(i.getZoom()===i.getMinZoom()&&this._scale<1||i.getZoom()===i.getMaxZoom()&&this._scale>1)return;if(!this._moved)t.DomUtil.addClass(i._mapPane,"leaflet-touching"),i.fire("movestart").fire("zoomstart"),this._moved=!0;t.Util.cancelAnimFrame(this._animRequest),this._animRequest=t.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),t.DomEvent.preventDefault(e)},_updateOnMove:function(){var t=this._map,i=this._getScaleOrigin(),e=t.layerPointToLatLng(i),n=t.getScaleZoom(this._scale);t._animateZoom(e,n,this._startCenter,this._scale,this._delta,!1,!0)},_onTouchEnd:function(){if(!this._moved||!this._zooming)return void(this._zooming=!1);var e=this._map;this._zooming=!1,t.DomUtil.removeClass(e._mapPane,"leaflet-touching"),t.Util.cancelAnimFrame(this._animRequest),t.DomEvent.off(i,"touchmove",this._onTouchMove).off(i,"touchend",this._onTouchEnd);var o=this._getScaleOrigin(),r=e.layerPointToLatLng(o),s=e.getZoom(),n=e.getScaleZoom(this._scale)-s,h=n>0?Math.ceil(n):Math.floor(n),a=e._limitZoom(s+h),l=e.getZoomScale(a)/this._scale;e._animateZoom(r,a,o,l)},_getScaleOrigin:function(){var t=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(t)}}),t.Map.addInitHook("addHandler","touchZoom",t.Map.TouchZoom),t.Map.mergeOptions({tap:!0,tapTolerance:15}),t.Map.Tap=t.Handler.extend({addHooks:function(){t.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){t.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(e){if(!e.touches)return;if(t.DomEvent.preventDefault(e),this._fireClick=!0,e.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var n=e.touches[0],o=n.target;if(this._startPos=this._newPos=new t.Point(n.clientX,n.clientY),o.tagName&&"a"===o.tagName.toLowerCase())t.DomUtil.addClass(o,"leaflet-active");this._holdTimeout=setTimeout(t.bind(function(){if(this._isTapValid())this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",n)},this),1e3),t.DomEvent.on(i,"touchmove",this._onMove,this).on(i,"touchend",this._onUp,this)},_onUp:function(n){if(clearTimeout(this._holdTimeout),t.DomEvent.off(i,"touchmove",this._onMove,this).off(i,"touchend",this._onUp,this),this._fireClick&&n&&n.changedTouches){var o=n.changedTouches[0],e=o.target;if(e&&e.tagName&&"a"===e.tagName.toLowerCase())t.DomUtil.removeClass(e,"leaflet-active");if(this._isTapValid())this._simulateEvent("click",o)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(e){var i=e.touches[0];this._newPos=new t.Point(i.clientX,i.clientY)},_simulateEvent:function(o,t){var n=i.createEvent("MouseEvents");n._simulated=!0,t.target._simulatedClick=!0,n.initMouseEvent(o,!0,!0,e,1,t.screenX,t.screenY,t.clientX,t.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(n)}}),t.Browser.touch&&!t.Browser.pointer)t.Map.addInitHook("addHandler","tap",t.Map.Tap);if(t.Map.mergeOptions({boxZoom:!0}),t.Map.BoxZoom=t.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._moved=!1},addHooks:function(){t.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){t.DomEvent.off(this._container,"mousedown",this._onMouseDown),this._moved=!1},moved:function(){return this._moved},_onMouseDown:function(e){if(this._moved=!1,!e.shiftKey||1!==e.which&&1!==e.button)return!1;t.DomUtil.disableTextSelection(),t.DomUtil.disableImageDrag(),this._startLayerPoint=this._map.mouseEventToLayerPoint(e),t.DomEvent.on(i,"mousemove",this._onMouseMove,this).on(i,"mouseup",this._onMouseUp,this).on(i,"keydown",this._onKeyDown,this)},_onMouseMove:function(s){if(!this._moved)this._box=t.DomUtil.create("div","leaflet-zoom-box",this._pane),t.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",this._map.fire("boxzoomstart");